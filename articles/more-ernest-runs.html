<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>More Ernest Runs • ernest</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="More Ernest Runs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ernest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/more-ernest-runs.html">More Ernest Runs</a></li>
    <li><a class="dropdown-item" href="../articles/nested-sampling-with-ernest.html">A Nested Sampling Crash Course with Ernest</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylesnap/ernest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>More Ernest Runs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kylesnap/ernest/blob/ropensci_submission/vignettes/more-ernest-runs.Rmd" class="external-link"><code>vignettes/more-ernest-runs.Rmd</code></a></small>
      <div class="d-none name"><code>more-ernest-runs.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kylesnap.github.io/ernest/">ernest</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette demonstrates how to use the ernest package to solve
several classical nested sampling problems. These examples are based on
standard benchmarks from the literature and are also used in the
package’s test suite to validate correctness. You’ll learn how to
specify likelihoods and priors, run nested sampling, and interpret the
results.</p>
<div class="section level2">
<h2 id="gaussian-shells">1. Gaussian Shells<a class="anchor" aria-label="anchor" href="#gaussian-shells"></a>
</h2>
<p>The “Gaussian shells” problem is a standard test for nested sampling
algorithms, as they illustrate the ability of nested sampling to deal
with oddly-shaped distributions that can be difficult to traverse with
traditional random-walk MCMC methods.</p>
<p>We will solve the shells problem in 2 and 5 dimensions. To make this
easier, we’ll build a function factory to specify the log-likelihood of
two Gaussian shells in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>-dimensional
space, with one shell offset in the first dimension by 3.5.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gaussian_shell</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_dim</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">c_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_dim</span><span class="op">)</span> <span class="co"># Center of shell 1</span></span>
<span>  <span class="va">c_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_dim</span><span class="op">)</span> <span class="co"># Center of shell 2</span></span>
<span>  <span class="va">c_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3.5</span> <span class="co"># 1D of the first shell is off-center</span></span>
<span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Radius</span></span>
<span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Shell width</span></span>
<span>  <span class="va">const</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">w</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Single-shell log likelihood</span></span>
<span>  <span class="va">log_lik_shell</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">c</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">theta</span> <span class="op">-</span> <span class="va">c</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">const</span> <span class="op">-</span> <span class="op">(</span><span class="va">d</span> <span class="op">-</span> <span class="va">r</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">w</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># log-likelihood of two shells</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">matrixStats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/matrixStats/man/logSumExp.html" class="external-link">logSumExp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fu">log_lik_shell</span><span class="op">(</span><span class="va">theta</span>, <span class="va">c_1</span><span class="op">)</span>,</span>
<span>      <span class="fu">log_lik_shell</span><span class="op">(</span><span class="va">theta</span>, <span class="va">c_2</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="shells-in-2d">1.1. Shells in 2D<a class="anchor" aria-label="anchor" href="#shells-in-2d"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_lik_2d</span> <span class="op">&lt;-</span> <span class="fu">gaussian_shell</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">prior_2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_uniform_prior.html">create_uniform_prior</a></span><span class="op">(</span></span>
<span>  n_dim <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="fl">6</span>,</span>
<span>  upper <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sampler_2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nested_sampling.html">nested_sampling</a></span><span class="op">(</span><span class="va">log_lik_2d</span>, <span class="va">prior_2d</span><span class="op">)</span></span>
<span><span class="va">run_2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate</a></span><span class="op">(</span><span class="va">sampler_2d</span><span class="op">)</span></span>
<span><span class="co">#&gt; ⠙ Generating nested samples | 1850 iter. | 38001 lik. calls |1.11067806619135 e…</span></span>
<span><span class="co">#&gt; `min_logz` reached (0.0499193129857218 &lt; 0.05)</span></span>
<span><span class="co">#&gt; ⠙ Generating nested samples | 3373 iter. | 76101 lik. calls |0.0499193129857218…</span></span>
<span><span class="va">run_2d</span></span>
<span><span class="co">#&gt; An <span style="color: #0000BB;">&lt;ernest_run&gt;</span>: 500 points x 3373 iter x 76101 lik. calls</span></span>
<span><span class="co">#&gt; → Log. Evidence: <span style="color: #0000BB;">-1.657</span> ± <span style="color: #0000BB;">0.085</span></span></span></code></pre></div>
<p>We can review the results with more detail using
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">run_2d</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Nested Sampling Results from </span><span style="color: #0000BB; font-weight: bold;">&lt;ernest_run&gt;</span> <span style="color: #00BBBB;">───────────────────────────────────</span></span></span>
<span><span class="co">#&gt; No. Points: 500</span></span>
<span><span class="co">#&gt; No. Iterations: 3373</span></span>
<span><span class="co">#&gt; No. Lik. Calls: 76101</span></span>
<span><span class="co">#&gt; Log. Evidence: -1.657 (± 0.08518)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shells-in-5d">1.2. Shells in 5D<a class="anchor" aria-label="anchor" href="#shells-in-5d"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_lik_5d</span> <span class="op">&lt;-</span> <span class="fu">gaussian_shell</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">prior_5d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_uniform_prior.html">create_uniform_prior</a></span><span class="op">(</span></span>
<span>  n_dim <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="fl">6</span>,</span>
<span>  upper <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  varnames <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sampler_5d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nested_sampling.html">nested_sampling</a></span><span class="op">(</span><span class="va">log_lik_5d</span>, <span class="va">prior_5d</span><span class="op">)</span></span>
<span><span class="va">run_5d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate</a></span><span class="op">(</span><span class="va">sampler_5d</span><span class="op">)</span></span>
<span><span class="co">#&gt; ⠙ Generating nested samples | 1900 iter. | 39231 lik. calls |116.227456835908 e…</span></span>
<span><span class="co">#&gt; ⠹ Generating nested samples | 2406 iter. | 51881 lik. calls |38.122427430492 es…</span></span>
<span><span class="co">#&gt; ⠸ Generating nested samples | 3981 iter. | 91256 lik. calls |0.699290898787305 …</span></span>
<span><span class="co">#&gt; ⠼ Generating nested samples | 5249 iter. | 122956 lik. calls |0.053799415751631…</span></span>
<span><span class="co">#&gt; `min_logz` reached (0.0499635677380943 &lt; 0.05)</span></span>
<span><span class="co">#&gt; ⠼ Generating nested samples | 5285 iter. | 123881 lik. calls |0.049963567738094…</span></span>
<span><span class="va">run_5d</span></span>
<span><span class="co">#&gt; An <span style="color: #0000BB;">&lt;ernest_run&gt;</span>: 500 points x 5285 iter x 123881 lik. calls</span></span>
<span><span class="co">#&gt; → Log. Evidence: <span style="color: #0000BB;">-5.494</span> ± <span style="color: #0000BB;">0.128</span></span></span></code></pre></div>
<p>If we wanted to ensure ourselves that our prior was behaving as
expected, we can use the <code>posterior</code> package to examine our
recorded samples.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/" class="external-link">posterior</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is posterior version 1.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'posterior'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     mad, sd, var</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     %in%, match</span></span>
<span><span class="va">draws_5d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/draws.html" class="external-link">as_draws</a></span><span class="op">(</span><span class="va">run_5d</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/extract_variable.html" class="external-link">extract_variable</a></span><span class="op">(</span><span class="va">draws_5d</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -5.976671  5.998386</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/extract_variable.html" class="external-link">extract_variable</a></span><span class="op">(</span><span class="va">draws_5d</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -5.985512  5.972210</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-eggbox-distribution">2. The Eggbox distribution<a class="anchor" aria-label="anchor" href="#the-eggbox-distribution"></a>
</h2>
<p>The eggbox is a highly multimodal likelihood surface, used as another
classical example in nested sampling.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eggbox_loglik</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">(</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">5</span></span>
<span><span class="op">}</span></span>
<span><span class="va">prior_eggbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_uniform_prior.html">create_uniform_prior</a></span><span class="op">(</span>n_dim <span class="op">=</span> <span class="fl">2</span>, upper <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span></span>
<span><span class="va">sampler_eggbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nested_sampling.html">nested_sampling</a></span><span class="op">(</span><span class="va">eggbox_loglik</span>, <span class="va">prior_eggbox</span><span class="op">)</span></span>
<span><span class="va">run_eggbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate</a></span><span class="op">(</span><span class="va">sampler_eggbox</span><span class="op">)</span></span>
<span><span class="co">#&gt; ⠙ Generating nested samples | 2522 iter. | 54101 lik. calls |8.97438818772907 e…</span></span>
<span><span class="co">#&gt; ⠹ Generating nested samples | 4221 iter. | 96576 lik. calls |0.254322669332915 …</span></span>
<span><span class="co">#&gt; `min_logz` reached (0.0499928249847282 &lt; 0.05)</span></span>
<span><span class="co">#&gt; ⠹ Generating nested samples | 4996 iter. | 115976 lik. calls |0.049992824984728…</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">run_eggbox</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Nested Sampling Results from </span><span style="color: #0000BB; font-weight: bold;">&lt;ernest_run&gt;</span> <span style="color: #00BBBB;">───────────────────────────────────</span></span></span>
<span><span class="co">#&gt; No. Points: 500</span></span>
<span><span class="co">#&gt; No. Iterations: 4996</span></span>
<span><span class="co">#&gt; No. Lik. Calls: 115976</span></span>
<span><span class="co">#&gt; Log. Evidence: 236 (± 0.1259)</span></span></code></pre></div>
<p>We can plot the run to examine how our evidence estimates changed
over time:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">run_eggbox</span><span class="op">)</span></span></code></pre></div>
<p><img src="more-ernest-runs_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Additionally, we can use <code>calculate</code> to simulate
uncertainty around our log volume estimates. As a shortcut, we can use
<code>plot</code> with a non-zero <code>ndraws</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">run_eggbox</span>, ndraws <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="more-ernest-runs_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="working-with-data">3. Working with Data<a class="anchor" aria-label="anchor" href="#working-with-data"></a>
</h2>
<p>To use data within an ernest run, you’ll have to incorporate it
within your log-likelihood function. In many cases, this can be done
through using an anonymous function: If <code>f</code> is a function
that takes in parameters <code>theta</code> and data <code>y</code>,
then you can pass data through to ernest by using the syntax
<code>\(theta) f(theta, y)</code>.</p>
<p>As a demonstration, consider how ernest performs posterior estimation
for <a href="https://www.itl.nist.gov/div898/strd/mcmc/mcmc01.html" class="external-link">this</a>
dataset from the National Institutte of Science and Technology.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># NIST dataset</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">100000000.2</span>, <span class="fl">100000000.1</span>, <span class="fl">100000000.3</span>, <span class="fl">100000000.1</span>, <span class="fl">100000000.3</span>,</span>
<span>  <span class="fl">100000000.1</span>, <span class="fl">100000000.3</span>, <span class="fl">100000000.1</span>, <span class="fl">100000000.3</span>, <span class="fl">100000000.1</span>, <span class="fl">100000000.3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_lik_norm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">prior_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_normal_prior.html">create_normal_prior</a></span><span class="op">(</span></span>
<span>  n_dim <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100000000</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sampler_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nested_sampling.html">nested_sampling</a></span><span class="op">(</span></span>
<span>  log_lik <span class="op">=</span> \<span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="fu">log_lik_norm</span><span class="op">(</span><span class="va">theta</span>, y <span class="op">=</span> <span class="va">data</span><span class="op">)</span>,</span>
<span>  <span class="va">prior_norm</span></span>
<span><span class="op">)</span></span>
<span><span class="va">run_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate</a></span><span class="op">(</span><span class="va">sampler_norm</span><span class="op">)</span></span>
<span><span class="co">#&gt; ⠙ Generating nested samples | 1987 iter. | 41576 lik. calls |29.2228845109674 e…</span></span>
<span><span class="co">#&gt; ⠹ Generating nested samples | 2273 iter. | 48726 lik. calls |26.9337165207117 e…</span></span>
<span><span class="co">#&gt; ⠸ Generating nested samples | 3979 iter. | 91376 lik. calls |11.3028023901594 e…</span></span>
<span><span class="co">#&gt; ⠼ Generating nested samples | 5278 iter. | 123851 lik. calls |2.22078123767912 …</span></span>
<span><span class="co">#&gt; ⠴ Generating nested samples | 6418 iter. | 152351 lik. calls |0.201907052412492…</span></span>
<span><span class="co">#&gt; `min_logz` reached (0.0499641175158137 &lt; 0.05)</span></span>
<span><span class="co">#&gt; ⠴ Generating nested samples | 7088 iter. | 169126 lik. calls |0.049964117515813…</span></span>
<span><span class="va">run_norm</span></span>
<span><span class="co">#&gt; An <span style="color: #0000BB;">&lt;ernest_run&gt;</span>: 500 points x 7088 iter x 169126 lik. calls</span></span>
<span><span class="co">#&gt; → Log. Evidence: <span style="color: #0000BB;">-0.909</span> ± <span style="color: #0000BB;">0.161</span></span></span></code></pre></div>
<p>To examine the posterior, we need to first call
<code><a href="https://mc-stan.org/posterior/reference/resample_draws.html" class="external-link">posterior::resample_draws()</a></code> on the <code>draws</code>
arugment produced from an <code>ernest_run</code>. This is because
<code>ernest</code> binds the log-importance posterior weights to the
<code>as_draws</code> object as a hidden variable.</p>
<p>Once this is done, we can use the <code>posterior</code> package to
examine the posterior distribution</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/draws.html" class="external-link">as_draws</a></span><span class="op">(</span><span class="va">run_norm</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/resample_draws.html" class="external-link">resample_draws</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html" class="external-link">summarize_draws</a></span><span class="op">(</span><span class="va">draws_norm</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 10</span></span></span>
<span><span class="co">#&gt;   variable    mean  median     sd    mad      q5     q95  rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> mean     1.00<span style="color: #949494;">e</span>+8 1.00<span style="color: #949494;">e</span>+8 0.035<span style="text-decoration: underline;">9</span> 0.033<span style="text-decoration: underline;">3</span> 1.00<span style="color: #949494;">e</span>+8 1.00<span style="color: #949494;">e</span>+8  1.33  <span style="text-decoration: underline;">2</span>353.       12.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> sd       1.14<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> 1.09<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> 0.031<span style="text-decoration: underline;">9</span> 0.026<span style="text-decoration: underline;">6</span> 7.56<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 1.72<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>  1.27     4.87     11.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Dewsnap.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
