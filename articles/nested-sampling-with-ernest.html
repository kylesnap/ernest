<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Nested Sampling with Ernest • ernest</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nested Sampling with Ernest">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ernest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/nested-sampling-with-ernest.html">Nested Sampling with Ernest</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Nested Sampling with Ernest</h1>
            
      

      <div class="d-none name"><code>nested-sampling-with-ernest.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kylesnap.github.io/ernest/">ernest</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>Nested sampling (NS) is a Bayesian statistical method designed to
address the problems of parameter estimation and model selection. At its
most general, (NS) is a method for estimating a solution to a integral
over a high-dimensional space; in practice, this integral is usually the
marginal likelihood of a given model given some data, over a specified
prior parameter space. The method, originally introduced by John
Skilling, has since been applied to a wide range of problems in
astrophysics, cosmology, and other fields.</p>
<p>The Easy R Nested Sampling Toolkit (or <code>ernest</code>) provides
a collection of tools for performing nested sampling within
<code>R</code>. Given a user-provided log-likelihood function contains
functions for starting, continuing, and reviewing the results of a
nested sampling run. The package is designed to be flexible and easy to
use, and is intended to be a useful tool for researchers who wish to
apply nested sampling to their own problems. This document glosses over
the mathematical details that allow for nested sampling, instead
focussing on providing an overview of <code>ernest</code>’s
construction, and with providing an example of how it can be applied
within a statistical analysis.</p>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>In addition to specifying the dimensionality of their problem (i.e.,
how many parameters are in their model of interest, or
<code>n_dim</code>), <code>ernest</code> requires the user to provide
two functions that describe the model’s log-likelihood and a prior space
transformation.</p>
<div class="section level3">
<h3 id="log-likelihood-function-log_lik">Log-Likelihood Function: <code>log_lik</code><a class="anchor" aria-label="anchor" href="#log-likelihood-function-log_lik"></a>
</h3>
<p>This function must take in a vector of parameters equal in length to
<code>n_dim</code>. For each input, the function should return the
scalar-valued log-likelihood of the model. In cases where the this value
is not finite, the function should return <code>-Inf</code>.</p>
<div class="section level4">
<h4 id="example-a-two-dimensional-multivariate-gaussian-distribution">Example: A Two-Dimensional Multivariate Gaussian Distribution<a class="anchor" aria-label="anchor" href="#example-a-two-dimensional-multivariate-gaussian-distribution"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_dim</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">num_dim</span><span class="op">)</span></span>
<span><span class="va">sigma</span><span class="op">[</span><span class="va">sigma</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.95</span></span>
<span></span>
<span><span class="va">log_lik</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">dmvnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">sigma</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>    <span class="st">"x"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>, </span>
<span>    <span class="st">"y"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"ll"</span> <span class="op">=</span> <span class="fu">log_lik</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">ll</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">LL</span><span class="op">)</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="nested-sampling-with-ernest_files/figure-html/unnamed-chunk-2-1.png" width="700">
## Prior Space Transformation: <code>prior_transform</code></p>
<p>Like other implementations of nested sampling, <code>ernest</code>
generates possible parameter vectors by performing likelihood-restricted
prior sampling within the (0-1)-unit hypercube. The
<code>prior_transform</code> function is responsible for taking these
vectors and transforming it to the original parameter space specified by
a given prior distribution.</p>
<p>This function must take in a vector of parameters equal in length to
<code>n_dim</code> whose components are guaranteed to be in the range
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math>.
For each input, the function must return an <code>n_dim</code>-length
vector of parameters in the original parameter space. Each component of
this vector should be a finite value.</p>
</div>
<div class="section level4">
<h4 id="example-a-uniform-prior-in-2d-space">Example: A Uniform Prior in 2D-Space<a class="anchor" aria-label="anchor" href="#example-a-uniform-prior-in-2d-space"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_t</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">qunif</a></span><span class="op">(</span><span class="va">u</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-a-uniform-prior-in-2d-space-heterogenous-scales">Example: A Uniform Prior in 2D-Space (Heterogenous Scales)<a class="anchor" aria-label="anchor" href="#example-a-uniform-prior-in-2d-space-heterogenous-scales"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_t2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">qunif</a></span><span class="op">(</span><span class="va">u</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">qunif</a></span><span class="op">(</span><span class="va">u</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, max <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="choosing-a-likelihood-restricted-prior-sampler">Choosing a Likelihood-Restricted Prior Sampler<a class="anchor" aria-label="anchor" href="#choosing-a-likelihood-restricted-prior-sampler"></a>
</h3>
<p>Nested samplers require a method for generating proposed parameter
vectors by taking independent samples from the prior distribution,
conditional on some minimum likelihood constraint. Currently,
<code>ernest</code> offers two samplers that can be chosen using the
<code>sampler</code> argument on <code><a href="../reference/nested_sampling.html">nested_sampling()</a></code>, but
more sophisticated options are scheduled for development.</p>
<div class="section level4">
<h4 id="uniform-sampling-uniform_cube">Uniform Sampling: <code>uniform_cube()</code><a class="anchor" aria-label="anchor" href="#uniform-sampling-uniform_cube"></a>
</h4>
<p>The <code>uniform_cube()</code> is the most basic implementation of a
region-based sampler, where points are proposed by sampling uniformly
within the unit hypercube until a point exceeds the likelihood
constraint. This method is helpful for verifying the correctness of a
nested sampling run by performing it with limited iterations, but its
inefficiency renders it largely unhelpful for practical use.</p>
<p>Calling <code><a href="../reference/lrps.html">unif_cube()</a></code> also provides the user an
opportunity to set the <code>ernest.max_loop</code> option in their
environment. This is intend to serve as a safety check, killing a run if
a sampler exceeds a reasonable number of iterations in attempting to
proposal a point under the likelihood contraint. As such, it generally
should be set to a very high number, with <code>1e6L</code> being the
default.</p>
</div>
<div class="section level4">
<h4 id="random-walk-in-the-unit-hypercube-rwmh_cube">Random Walk in the Unit Hypercube: <code>rwmh_cube()</code><a class="anchor" aria-label="anchor" href="#random-walk-in-the-unit-hypercube-rwmh_cube"></a>
</h4>
<p>The <code>rwmh_cube</code> is a basic implementation of a MCMC-based
sampler, where points are generated by performing a random walk within
the unit hypercube, accepting proposed points that exceed the likelihood
constraint. This method closely resembles the original proposed LRPS
detailed in Skilling, and is reasonably effective for low- to
middle-dimensional problems (i.e., between 1-to-20).</p>
<p>The user can set the number of steps, the initial step size, and the
target acceptance ratio of the sampler. Unlike Skilling’s original LRPS,
<code>ernest</code> applies a Newton-Raphson optimization to adjust the
step size throughout the run to target the desired acceptance ratio. The
number of calls to the likelihood function between each update can be
set with the <code>update_interval</code> argument in
<code><a href="../reference/nested_sampling.html">nested_sampling()</a></code>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="running-nested-sampling-with-ernest">Running Nested Sampling with <code>Ernest</code><a class="anchor" aria-label="anchor" href="#running-nested-sampling-with-ernest"></a>
</h2>
<p>Using the 2D-Gaussian likelihood example provided earlier, along with
the uniform gaussian prior, we can perform a nested sampling run with
the <code><a href="../reference/lrps.html">rwmh_cube()</a></code> sampler. First,
<code><a href="../reference/nested_sampling.html">nested_sampling()</a></code> takes in the user provided functions, a
<code>ptype</code> defining the number of variables or a vector of
character names (should one want prettier output), and other user-set
parameters. Importantly, the user can set the <code>verbose</code>
parameter to <code>TRUE</code> to receive updates on the progress of the
run.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampler</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nested_sampling.html">nested_sampling</a></span><span class="op">(</span></span>
<span>  <span class="va">log_lik</span>,</span>
<span>  prior_transform <span class="op">=</span> <span class="va">prior_t</span>,</span>
<span>  ptype <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">500L</span>,</span>
<span>  sampler <span class="op">=</span> <span class="fu"><a href="../reference/lrps.html">rwmh_cube</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sampler</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Nested Sampling Run from </span><span style="color: #0000BB; font-style: italic;">ernest</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">500</span> Live Points, <span style="color: #0000BB;">0</span> Samples Generated.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Estimate log. evidence with `generate()`.</span></span></code></pre></div>
<p>This produces an <code>R6</code> object with the class
<code>ernest_sampler</code>. This object is responsible for dispatching
across the various functions that <code>ernest</code> provides for
generating and reviewing the results of a nested sampling run.</p>
<p>To begin nested sampling, the <code><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate()</a></code> method is
called on <code>sampler</code>. This accepts a number of parameters that
indicate at which point to stop nested sampling. For example, one can
run the sampling until 1000 iterations are performed.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate</a></span><span class="op">(</span><span class="va">sampler</span>, max_iterations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">run1</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Nested Sampling Run from </span><span style="color: #0000BB; font-style: italic;">ernest</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">500</span> Live Points, <span style="color: #0000BB;">1000</span> Samples Generated.</span></span>
<span><span class="co">#&gt; Estimated Log. Evidence: -6.2767</span></span></code></pre></div>
<p>To improve the evidence estimate from this model, the user can
continue a run by calling <code><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate()</a></code> on a
previously-generated <code>ErnestSampler</code>. By setting the
<code>dlogz</code> option, nested sampling will be stopped once the
log-ratio between the current estimated evidence and the remaining
evidence falls below some criterion.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate</a></span><span class="op">(</span><span class="va">sampler</span>, min_logz <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">run2</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Nested Sampling Run from </span><span style="color: #0000BB; font-style: italic;">ernest</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">500</span> Live Points, <span style="color: #0000BB;">4237</span> Samples Generated.</span></span>
<span><span class="co">#&gt; Estimated Log. Evidence: -6.1186</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>A nested sampling run’s results can be viewed by calling different
arguments over the <code>ErnestSampler</code> object. For example, by
calling <code><a href="https://generics.r-lib.org/reference/calculate.html" class="external-link">calculate()</a></code> on <code>run2</code>, one receives a
<code>tibble</code> containing the results of the iterative evidence
estimates.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">integral</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/calculate.html" class="external-link">calculate</a></span><span class="op">(</span><span class="va">run2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">integral</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   .iter log_lik log_vol log_weight log_z log_z_var information</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">4</span>732  -<span style="color: #BB0000;">0.674</span>   -<span style="color: #BB0000;">12.9</span>      -<span style="color: #BB0000;">15.4</span> -<span style="color: #BB0000;">6.12</span>    0.010<span style="text-decoration: underline;">8</span>        4.50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">4</span>733  -<span style="color: #BB0000;">0.674</span>   -<span style="color: #BB0000;">13.1</span>      -<span style="color: #BB0000;">15.4</span> -<span style="color: #BB0000;">6.12</span>    0.010<span style="text-decoration: underline;">9</span>        4.50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">4</span>734  -<span style="color: #BB0000;">0.674</span>   -<span style="color: #BB0000;">13.3</span>      -<span style="color: #BB0000;">15.4</span> -<span style="color: #BB0000;">6.12</span>    0.011<span style="text-decoration: underline;">0</span>        4.50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">4</span>735  -<span style="color: #BB0000;">0.674</span>   -<span style="color: #BB0000;">13.6</span>      -<span style="color: #BB0000;">15.4</span> -<span style="color: #BB0000;">6.12</span>    0.011<span style="text-decoration: underline;">2</span>        4.50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">4</span>736  -<span style="color: #BB0000;">0.674</span>   -<span style="color: #BB0000;">14.0</span>      -<span style="color: #BB0000;">15.4</span> -<span style="color: #BB0000;">6.12</span>    0.011<span style="text-decoration: underline;">4</span>        4.50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">4</span>737  -<span style="color: #BB0000;">0.674</span>   -<span style="color: #BB0000;">14.7</span>      -<span style="color: #BB0000;">15.4</span> -<span style="color: #BB0000;">6.12</span>    0.011<span style="text-decoration: underline;">7</span>        4.50</span></span></code></pre></div>
<p>The change in the evidence estimate over the course of the run can be
visualized by calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on the
<code>ErnestSampler</code> object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">run2</span><span class="op">)</span></span></code></pre></div>
<p><img src="nested-sampling-with-ernest_files/figure-html/unnamed-chunk-9-1.png" width="700">
We can also produce trace plots of the distributions of the points
across the run by calling <code>visualize(which = "trace")</code> on the
<code>ErnestSampler</code> object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_df.html" class="external-link">as_draws_df</a></span><span class="op">(</span><span class="va">run2</span>, unit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">draws</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`.draw`</span>, y <span class="op">=</span> <span class="va">`X...1`</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">`.log_weight`</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span><span class="st">"Post. Weight"</span><span class="op">)</span></span></code></pre></div>
<p><img src="nested-sampling-with-ernest_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">draws</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`.draw`</span>, y <span class="op">=</span> <span class="va">`X...2`</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">`.log_weight`</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span><span class="st">"Post. Weight"</span><span class="op">)</span></span></code></pre></div>
<p><img src="nested-sampling-with-ernest_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Dewsnap.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
