<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A Toolkit for Nested Sampling • ernest</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="A Toolkit for Nested Sampling">
<meta name="description" content="Bayesian evidence estimation and posterior inference with the nested sampling algorithm, along with S3 methods for simulating uncertainty and creating visualisations.">
<meta property="og:description" content="Bayesian evidence estimation and posterior inference with the nested sampling algorithm, along with S3 methods for simulating uncertainty and creating visualisations.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ernest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/more-ernest-runs.html">More Examples with ernest</a></li>
    <li><a class="dropdown-item" href="articles/nested-sampling-with-ernest.html">Nested Sampling with ernest</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylesnap/ernest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="a-toolkit-for-nested-sampling">A Toolkit for Nested Sampling<a class="anchor" aria-label="anchor" href="#a-toolkit-for-nested-sampling"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p><strong>ernest</strong> is a comprehensive toolkit for <a href="https://en.wikipedia.org/wiki/Nested_sampling_algorithm" class="external-link">nested sampling</a> (NS), an algorithm for estimating a statistical model’s Bayesian evidence and posterior distribution. It provides S3 objects and methods that make nested sampling accessible, flexible, and robust within the R environment.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the development version of ernest from <a href="https://github.com/kylesnap/ernest" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"kylesnap/ernest"</span><span class="op">)</span></span></code></pre></div>
<p>You’ll also need a working C++ compiler. To get it:</p>
<ul>
<li><p>On Windows, install <a href="#id_0">Rtools</a>.</p></li>
<li><p>On Mac, install Xcode from the app store.</p></li>
<li><p>On Linux, <code>sudo apt-get install r-base-dev</code> or similar.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="why-use-ernest">Why use ernest?<a class="anchor" aria-label="anchor" href="#why-use-ernest"></a>
</h2>
<p>Often, statisticians are faced with multiple competing models that intend to describe or estimate a given data set. One way to compare these models against each other is by evaluating model evidence (also called <a href="https://en.wikipedia.org/wiki/Marginal_likelihood" class="external-link">marginal likelihood</a>), found by integrating a model’s likelihood function across all possible values of its parameters. In Bayesian inference, evidence represents the parameter-independent probability of the data occurring under a given model—calculating and comparing evidence values across different models, such as through using <a href="https://en.wikipedia.org/wiki/Bayes_factor" class="external-link">Bayes factors</a>, plays an important role in Bayesian inference.</p>
<p>Calculating evidence directly is challenging, as it requires evaluating a high-dimensional integral over the parameter space. Nested sampling estimates this integral by dividing the space into a series of small volumes. It starts by drawing points from the prior and ranking them by likelihood. The least likely points are discarded and replaced with new samples from more restricted likelihood regions, gradually compressing the search space. Each round of discarding shrinks the explored volume in a predictable way, helping to approximate the integral.</p>
<p>This approach to estimating evidence offers several advantages over methods like Markov chain Monte Carlo (MCMC):</p>
<ul>
<li>
<strong>Robustness</strong>: NS handles complex likelihood surfaces that would otherwise be difficult to traverse, such as those with multiple modes or discontinuities.</li>
<li>
<strong>Posterior inference</strong>: After a run, discarded samples can be weighted to approximate the model’s posterior distribution.</li>
<li>
<strong>Natural stopping criterion</strong>: NS can estimate the amount of evidence left within the unexplored prior volume, and can stop sampling once this amount gets trivially small.</li>
<li>
<strong>Tractable uncertainty estimates</strong>: The shrinkage at each iteration follows a uniform order statistic, so uncertainty can be simulated using the results from a single run.</li>
</ul>
<p>ernest’s implementation of NS offers R users several benefits:</p>
<ul>
<li>
<strong>Native R implementation</strong>: John Skilling’s NS algorithm is implemented in R, with no Python or Fortran dependencies. (C++ is used to implement the included likelihood samplers to improve run-time efficiency).</li>
<li>
<strong>Type- and size-safety</strong>: ernest helps ensure that the user provides likelihood functions and prior specifications meet the requirements of the NS algorithm.</li>
<li>
<strong>Familiar methods</strong>: Sampler specifications and results are stored in S3 objects. Start or continue an NS run with <code><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate()</a></code>, review results with <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, and simulate estimation error with <code><a href="https://generics.r-lib.org/reference/calculate.html" class="external-link">calculate()</a></code>.</li>
<li>
<strong>Powerful visualizations</strong>: Plot evidence estimates and analyse posterior distributions using <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> and <a href="https://mc-stan.org/posterior/" class="external-link">posterior</a>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kylesnap.github.io/ernest/">ernest</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a prior (i.i.d. multivariate uniform)</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/special_priors.html">create_uniform_prior</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>, lower <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, upper <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a log-likelihood function (multivariate normal)</span></span>
<span><span class="va">log_lik_mvn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n_dim</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span>  <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0.95</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># Covariance matrix</span></span>
<span>  <span class="va">det_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/det.html" class="external-link">det</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span> <span class="co"># Precision matrix (Sigma^-1)</span></span>
<span>  <span class="va">log_norm</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span> <span class="op">*</span> <span class="va">n_dim</span> <span class="op">+</span> <span class="va">det_sigma</span><span class="op">)</span> <span class="co"># Normalization for MVG</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">theta</span>, <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">prec</span>, <span class="va">theta</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">log_norm</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Set up and run the sampler</span></span>
<span><span class="va">sampler</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ernest_sampler.html">ernest_sampler</a></span><span class="op">(</span></span>
<span>  <span class="va">log_lik_mvn</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">prior</span>,</span>
<span>  nlive <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span>
<span><span class="va">run</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/generate.html" class="external-link">generate</a></span><span class="op">(</span><span class="va">sampler</span>, show_progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize and visualize results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">run</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of nested sampling run:</span></span>
<span><span class="co">#&gt; ── Run Information ─────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; * No. points: 500</span></span>
<span><span class="co">#&gt; * Iterations: 4633</span></span>
<span><span class="co">#&gt; * Likelihood evals.: 101352</span></span>
<span><span class="co">#&gt; * Log-evidence: -8.9259 (± 0.1137)</span></span>
<span><span class="co">#&gt; * Information: 4.732</span></span>
<span><span class="co">#&gt; ── Posterior Summary ───────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 6</span></span>
<span><span class="co">#&gt;   variable      mean    sd   median   q15   q85</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 x        -0.0472    2.80  0.00714 -2.03  1.85</span></span>
<span><span class="co">#&gt; 2 y        -0.000385  2.81 -0.00925 -1.89  1.87</span></span>
<span><span class="co">#&gt; 3 z        -0.111     2.75 -0.0345  -2.01  1.78</span></span>
<span><span class="co">#&gt; ── Maximum Likelihood Estimate (MLE) ───────────────────────────────────────────</span></span>
<span><span class="co">#&gt; * Log-likelihood: -2.6811</span></span>
<span><span class="co">#&gt; * Original parameters: -0.0116, -0.0448, and -0.0105</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">run</span>, which <span class="op">=</span> <span class="st">"evidence"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/visualize.html" class="external-link">visualize</a></span><span class="op">(</span><span class="va">run</span>, <span class="va">x</span>, .which <span class="op">=</span> <span class="st">"trace"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-2.png" width="100%"></p>
<p>For advanced usage, including custom priors and hierarchical models, see the package vignettes.</p>
</div>
<div class="section level2">
<h2 id="prior-work">Prior Work<a class="anchor" aria-label="anchor" href="#prior-work"></a>
</h2>
<p>NS has been implemented in many languages. This non-exhaustive list of popular NS implementations is adapted from <a href="http://arxiv.org/abs/2010.13884" class="external-link">Fowlie (2021)</a>:</p>
<ul>
<li><p>In Python: <a href="https://github.com/kbarbary/nestle/tree/master" class="external-link">nestle</a> and <a href="https://github.com/joshspeagle/dynesty" class="external-link">dynesty</a></p></li>
<li><p>In C++: <a href="https://github.com/EnricoCorsaro/DIAMONDS/" class="external-link">DIAMONDS</a> and <a href="https://github.com/eggplantbren/DNest4" class="external-link">DNest4</a>*</p></li>
<li><p>In Fortran: <a href="https://github.com/JohannesBuchner/MultiNest" class="external-link">MultiNest</a>* and <a href="https://github.com/PolyChord/PolyChordLite" class="external-link">PolyChord</a></p></li>
</ul>
<p>(* Indicates software that includes an R interface.)</p>
<p>ernest’s design, API, and NS implementation are based on the nestle package, with further inspiration from dynesty.</p>
<p>The <a href="https://github.com/ejhigson/nestcheck/tree/master" class="external-link">nestcheck</a> Python package provides routines for error estimation and diagnostic plotting with nested sampling runs. Several of ernest’s methods are based on this work.</p>
</div>
<div class="section level2">
<h2 id="citing-ernest">Citing ernest<a class="anchor" aria-label="anchor" href="#citing-ernest"></a>
</h2>
<p>When using ernest, please at least include the following citations:</p>
<ul>
<li><p>Dewsnap K. (2025). “ernest: A Toolkit for Nested Sampling.” R package version XXX, &lt;URL: (<a href="https://kylesnap.github.io/ernest/" class="uri">https://kylesnap.github.io/ernest/</a>)&gt;</p></li>
<li><p>Skilling, J. (2006). Nested Sampling for General Bayesian Computation. <em>Bayesian Analysis</em>, 1(4), 833–859. &lt;DOI: <a href="https://doi.org/10.1214/06-BA127" class="external-link uri">https://doi.org/10.1214/06-BA127</a>&gt;</p></li>
<li><p>Buchner, J. (2023). Nested Sampling Methods. <em>Statistics Surveys</em>, 17, 169–215. &lt;DOI: <a href="https://doi.org/10.1214/23-SS144" class="external-link uri">https://doi.org/10.1214/23-SS144</a>&gt;</p></li>
</ul>
<p>Additional citations for ernest can be found in the package’s vignettes and within function documentation.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kylesnap/ernest/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/kylesnap/ernest/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ernest</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Kyle Dewsnap <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2132-8083" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kylesnap/ernest/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/kylesnap/ernest/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/kylesnap/ernest" class="external-link"><img src="https://codecov.io/gh/kylesnap/ernest/branch/ropensci_submission/graph/badge.svg?token=6HL8L046Y7" alt="codecov"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Dewsnap.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
