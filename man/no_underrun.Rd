% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/no_underrun.R
\name{no_underrun}
\alias{no_underrun}
\title{Generate samples with the No-Underrun Sampler (NURS)}
\usage{
no_underrun(adaptive_scale, fixed_scale, steps = 3, max_orbits = 8L)
}
\arguments{
\item{adaptive_scale, fixed_scale}{Choose one:
\itemize{
\item \code{adaptive_scale}: Number between 0 and 1. Updates the width of the sampling
lattice based on quantiles of inter-point distances.
\item \code{fixed_scale}: Positive number. Sets the width of the sampling lattice,
which remains constant throughout sampling.
}}

\item{steps}{Positive integer. Number of steps to take when generating a
proposal point.}

\item{max_orbits}{Positive integer. Controls the maximum size of the orbit
lattice built by the sampler (\code{2 ^ max_orbits}).}
}
\value{
An object of class \code{c("nurs", "ernest_lrps")} for use with
\code{\link[=ernest_sampler]{ernest_sampler()}} to specify sampling behaviour.
}
\description{
\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}
Propose points using a modified version
of the No-Underrun Sampler (NURS), a gradient-free variant of the No-U-Turn
Sampler (NUTS). Samples are generated by defining a line through an initial
live point and drawing candidates from a lattice along this line.
}
\details{
The No-Underrun Sampler (NURS) is a gradient-free Markov chain Monte Carlo
method, related to both Hit-and-Run and No-U-Turn Samplers. This function
adapts NURS for likelihood-restricted prior sampling, ensuring all samples
meet a minimum likelihood criterion.

For each \code{steps} of the algorithm, we do the following:
\enumerate{
\item From the current live point \eqn{x_0}, sample a direction \eqn{\rho} from
the unit hypersphere, defining a line through \eqn{x_0}.
\item Propose an initial shift along this line by a distance
\eqn{U[-h/2, h/2]}, where \eqn{h} is the current lattice scale. Accept if
the shifted point meets the likelihood criterion \eqn{c}.
\item Generate an orbit of points around the shifted \eqn{x_0} as a lattice
with spacing \eqn{h}, using a doubling procedure. Stop if (a) the orbit
exceeds the unit hypercube, or (b) the recursive condition
\deqn{max(l_{left}, l_{right}) < c} fails, where \eqn{l_{left}} and
\eqn{l_{right}} are the likelihoods at the lattice ends.
\item Randomly select one point from the final lattice as the new live point.
}

Choose \code{fixed_scale} to keep \eqn{h} constant, or \code{adaptive_scale} to update
\eqn{h} from inter-point distances. See References for details on tuning.
}
\examples{
# Basic usage with default parameters
lrps <- no_underrun(adaptive_scale = 0.01)

# Conservative settings for difficult problems
robust_lrps <- no_underrun(
  fixed_scale = 0.01,
  steps = 5
)

}
\references{
Bou-Rabee, N., Carpenter, B., Liu, S., & OberdÃ¶rster, S. (2025). The
No-Underrun Sampler: A Locally-Adaptive, Gradient-Free MCMC Method
(Version 2). arXiv. \doi{10.48550/ARXIV.2501.18548}
}
\seealso{
Other ernest_lrps: 
\code{\link{multi_ellipsoid}()},
\code{\link{rwmh_cube}()},
\code{\link{slice_rectangle}()},
\code{\link{unif_cube}()},
\code{\link{unif_ellipsoid}()}
}
\concept{ernest_lrps}
\keyword{internal}
