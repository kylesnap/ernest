<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Evidence using a Nested Sampling Run — calculate.ernest_run • ernest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Evidence using a Nested Sampling Run — calculate.ernest_run"><meta name="description" content="Estimate Evidence using a Nested Sampling Run"><meta property="og:description" content="Estimate Evidence using a Nested Sampling Run"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ernest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/nested-sampling-with-ernest.html">A Nested Sampling Crash Course with Ernest</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylesnap/ernest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate Evidence using a Nested Sampling Run</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylesnap/ernest/blob/ropensci_submission/R/calculate.R" class="external-link"><code>R/calculate.R</code></a></small>
      <div class="d-none name"><code>calculate.ernest_run.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate Evidence using a Nested Sampling Run</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'ernest_run'</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/calculate.html" class="external-link">calculate</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, ndraws <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>(ernest_run) An <code>ernest_run</code> object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>


<dt id="arg-ndraws">ndraws<a class="anchor" aria-label="anchor" href="#arg-ndraws"></a></dt>
<dd><p>(positive integer or zero, optional) The number of log volume
sequences to simulate. If equal to zero, no simulations will be made, and a
one draw vector of log volumes are produced from the estimates contained in
<code>x</code>. If <code>NULL</code>, <code>getOption("posterior.rvar_ndraws")</code> is used (default 4000).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble, containing <code>run$n_iter + run$n_points</code> rows and the
following columns:</p><ul><li><p><code>log_lik</code>: The log-likelihood of the model.</p></li>
<li><p><code>log_volume</code>: The log volume of the prior space.</p></li>
<li><p><code>log_weight</code>: The log weights of the live points.</p></li>
<li><p><code>log_evidence</code>: The log evidence of the model.</p></li>
<li><p><code>log_evidence_err</code>: The standard error of the log evidence (only available
when <code>ndraws = 0</code>).</p></li>
</ul><p>The tibble has the additional class <code>ernest_estimate</code>, which has its own
<a href="plot.ernest.html">plot</a> method.</p>
<p>Each column is returned as an <code><a href="https://mc-stan.org/posterior/reference/rvar.html" class="external-link">posterior::rvar()</a></code> vector.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Use <code><a href="https://generics.r-lib.org/reference/calculate.html" class="external-link">calculate()</a></code> to simulate the estimation error nested sampling runs caused
by approximating the change in log volume between iterations. Given the
use of ordered log likelihood restricted prior sampling, these volumes can be
modelled as the order statistics of a uniform random variable. Ernest uses the
following distributions to perform this simulation:</p><ul><li><p>Constant number of live points: At each iteration, the point with the
lowest likelihood is replaced by a new sample constrained to a higher
likelihood region. Under this setup, the shrinkage in prior volume at
iteration <code>i</code> can be shown to follow the Beta distribution.</p></li>
<li><p>Decreasing number of live points: At the end of the sampling run, the
remaining live points are added to the dead point set. This introduces a discrete
stepwise behavior in volume shrinkage. Ernest uses a transformation of variables
drawn from the exponential distribution to simulate the corresponding changes
in volume.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>See Appendix A6 of Speagle, J. (2020).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load an example run</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ernest_run_example</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View results as a tibble with `ndraws = FALSE` (the default).</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/calculate.html" class="external-link">calculate</a></span><span class="op">(</span><span class="va">ernest_run_example</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An <span style="color: #0000BB;">&lt;ernest_calculate&gt;</span>: 4000 draws x 10315 iterations</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate 100 simulated log volume values for each iteration.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/calculate.html" class="external-link">calculate</a></span><span class="op">(</span><span class="va">ernest_run_example</span>, ndraws <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An <span style="color: #0000BB;">&lt;ernest_calculate&gt;</span>: 100 draws x 10315 iterations</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Dewsnap.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

