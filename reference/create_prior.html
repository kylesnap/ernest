<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prepare a prior transformation for nested sampling — create_prior • ernest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare a prior transformation for nested sampling — create_prior"><meta name="description" content="Creates a prior transformation object of class ernest_prior, which defines
how to map points from the unit hypercube to the parameter space for use in
a nested sampling run."><meta property="og:description" content="Creates a prior transformation object of class ernest_prior, which defines
how to map points from the unit hypercube to the parameter space for use in
a nested sampling run."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ernest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/more-ernest-runs.html">More Examples with ernest</a></li>
    <li><a class="dropdown-item" href="../articles/nested-sampling-with-ernest.html">Nested Sampling with ernest</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylesnap/ernest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prepare a prior transformation for nested sampling</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylesnap/ernest/blob/main/R/prior-class.R" class="external-link"><code>R/prior-class.R</code></a></small>
      <div class="d-none name"><code>create_prior.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a prior transformation object of class <code>ernest_prior</code>, which defines
how to map points from the unit hypercube to the parameter space for use in
a nested sampling run.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_prior</span><span class="op">(</span></span>
<span>  <span class="va">point_fn</span>,</span>
<span>  <span class="va">vectorized_fn</span>,</span>
<span>  <span class="va">names</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  repair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unique"</span>, <span class="st">"universal"</span>, <span class="st">"check_unique"</span>, <span class="st">"unique_quiet"</span>, <span class="st">"universal_quiet"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'ernest_prior'</span></span>
<span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-point-fn-vectorized-fn">point_fn, vectorized_fn<a class="anchor" aria-label="anchor" href="#arg-point-fn-vectorized-fn"></a></dt>
<dd><p><code>[function]</code><br> The prior transformation
function. Provide either <code>point_fn</code> or <code>vectorized_fn</code>:</p><ul><li><p><code>point_fn</code>: Should accept a single parameter vector (numeric vector of
length equal to the number of parameters) and return a vector in the original
parameter space.</p></li>
<li><p><code>vectorized_fn</code>: Should accept a matrix of points in the unit hypercube
(rows as parameter vectors) and return a matrix of the same shape in the
original parameter space.</p></li>
</ul></dd>


<dt id="arg-names">names<a class="anchor" aria-label="anchor" href="#arg-names"></a></dt>
<dd><p><code>[character()]</code><br> Unique names for each variable in the prior
distribution.</p></dd>


<dt id="arg-lower-upper">lower, upper<a class="anchor" aria-label="anchor" href="#arg-lower-upper"></a></dt>
<dd><p><code>[double()]</code><br> Expected lower and upper bounds for the
parameter vectors after transformation.</p></dd>


<dt id="arg-repair">repair<a class="anchor" aria-label="anchor" href="#arg-repair"></a></dt>
<dd><p><code>[character(1)]</code><br> Name repair strategy for <code>names</code>. One of
<code>"check_unique"</code>, <code>"unique"</code>, <code>"universal"</code>, <code>"unique_quiet"</code>, or
<code>"universal_quiet"</code>. See <code><a href="https://vctrs.r-lib.org/reference/vec_as_names.html" class="external-link">vctrs::vec_as_names()</a></code> for details.</p></dd>


<dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>[ernest_prior]<br> Prior objects to combine.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>[ernest_prior]</code>, an object describing the prior transformation,
with <code>names</code>, <code>lower</code>, and <code>upper</code> recycled to the same length.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The prior transformation encodes points in the parameter space as independent
and identically distributed points within a unit hypercube. Nested sampling
implementations, including ernest, use this transformation to simplify
likelihood-restricted prior sampling and avoid unnecessary rejection steps.</p>
<p>Provide your prior as a transformation function. For factorisable priors,
this can simply transform each value in (0, 1) using the inverse CDF for each
parameter. For more complex cases, you can specify hierarchical or
conditionally dependent priors.</p>
<p><code>create_prior</code> performs regularity checks on your prior function to catch
basic errors that may affect nested sampling. The function must take in a
vector (or matrix) of points (each between 0 and 1) and return a vector or
matrix of the same shape containing only finite values.</p>
<p>If your prior depends on additional data, provide these using an anonymous
function (see Examples).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>See <a href="https://vctrs.r-lib.org/reference/theory-faq-recycling.html" class="external-link">vctrs::vector_recycling_rules</a> for information on how parameters
are recycled to a common length.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other priors:
<code><a href="special_priors.html">create_normal_prior()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Specify a prior with independent marginals</span></span></span>
<span class="r-in"><span><span class="va">normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="special_priors.html">create_normal_prior</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta0"</span>, <span class="st">"beta1"</span>, <span class="st">"beta2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  mean <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  sd <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">uniform</span> <span class="op">&lt;-</span> <span class="fu"><a href="special_priors.html">create_uniform_prior</a></span><span class="op">(</span>names <span class="op">=</span> <span class="st">"sd"</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">composite</span> <span class="op">&lt;-</span> <span class="va">normal</span> <span class="op">+</span> <span class="va">uniform</span></span></span>
<span class="r-in"><span><span class="va">composite</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> composite prior distribution with 4 dimensions (beta0, beta1, beta2, and sd)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Propose a conditional (hierarchical) prior in vectorized form</span></span></span>
<span class="r-in"><span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA_real_</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># x[1] follows N(5, 1)</span></span></span>
<span class="r-in"><span>  <span class="va">out</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># log10(x[2]) follows Uniform(-1, 1)</span></span></span>
<span class="r-in"><span>  <span class="va">out</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">qunif</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># x[3] follows N(x[1], x[2])</span></span></span>
<span class="r-in"><span>  <span class="va">out</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, mean <span class="op">=</span> <span class="va">out</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, sd <span class="op">=</span> <span class="va">out</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">out</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">conditional_prior</span> <span class="op">&lt;-</span> <span class="fu">create_prior</span><span class="op">(</span></span></span>
<span class="r-in"><span>  vectorized_fn <span class="op">=</span> <span class="va">fn</span>,</span></span>
<span class="r-in"><span>  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"x"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the marginals</span></span></span>
<span class="r-in"><span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="va">conditional_prior</span><span class="op">$</span><span class="fu">fn</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1000</span> <span class="op">*</span> <span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sample</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="create_prior-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sample</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="create_prior-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sample</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="create_prior-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Dewsnap.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

