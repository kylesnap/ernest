<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate samples with the No-Underrun Sampler (NURS) — no_underrun • ernest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate samples with the No-Underrun Sampler (NURS) — no_underrun"><meta name="description" content="
Propose points using a modified version
of the No-Underrun Sampler (NURS), a gradient-free variant of the No-U-Turn
Sampler (NUTS). Samples are generated by defining a line through an initial
live point and drawing candidates from a lattice along this line."><meta property="og:description" content="
Propose points using a modified version
of the No-Underrun Sampler (NURS), a gradient-free variant of the No-U-Turn
Sampler (NUTS). Samples are generated by defining a line through an initial
live point and drawing candidates from a lattice along this line."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ernest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/more-ernest-runs.html">More Nested Sampling Runs with Ernest</a></li>
    <li><a class="dropdown-item" href="../articles/nested-sampling-with-ernest.html">Quickstart: Nested Sampling with Ernest</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylesnap/ernest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate samples with the No-Underrun Sampler (NURS)</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylesnap/ernest/blob/main/R/no_underrun.R" class="external-link"><code>R/no_underrun.R</code></a></small>
      <div class="d-none name"><code>no_underrun.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
Propose points using a modified version
of the No-Underrun Sampler (NURS), a gradient-free variant of the No-U-Turn
Sampler (NUTS). Samples are generated by defining a line through an initial
live point and drawing candidates from a lattice along this line.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">no_underrun</span><span class="op">(</span><span class="va">adaptive_scale</span>, <span class="va">fixed_scale</span>, steps <span class="op">=</span> <span class="fl">3</span>, max_orbits <span class="op">=</span> <span class="fl">8L</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-adaptive-scale-fixed-scale">adaptive_scale, fixed_scale<a class="anchor" aria-label="anchor" href="#arg-adaptive-scale-fixed-scale"></a></dt>
<dd><p>Choose one:</p><ul><li><p><code>adaptive_scale</code>: Number between 0 and 1. Updates the width of the sampling
lattice based on quantiles of inter-point distances.</p></li>
<li><p><code>fixed_scale</code>: Positive number. Sets the width of the sampling lattice,
which remains constant throughout sampling.</p></li>
</ul></dd>


<dt id="arg-steps">steps<a class="anchor" aria-label="anchor" href="#arg-steps"></a></dt>
<dd><p>Positive integer. Number of steps to take when generating a
proposal point.</p></dd>


<dt id="arg-max-orbits">max_orbits<a class="anchor" aria-label="anchor" href="#arg-max-orbits"></a></dt>
<dd><p>Positive integer. Controls the maximum size of the orbit
lattice built by the sampler (<code>2 ^ max_orbits</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>c("nurs", "ernest_lrps")</code> for use with
<code><a href="ernest_sampler.html">ernest_sampler()</a></code> to specify sampling behaviour.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The No-Underrun Sampler (NURS) is a gradient-free Markov chain Monte Carlo
method, related to both Hit-and-Run and No-U-Turn Samplers. This function
adapts NURS for likelihood-restricted prior sampling, ensuring all samples
meet a minimum likelihood criterion.</p>
<p>For each <code>steps</code> of the algorithm, we do the following:</p><ol><li><p>From the current live point \(x_0\), sample a direction \(\rho\) from
the unit hypersphere, defining a line through \(x_0\).</p></li>
<li><p>Propose an initial shift along this line by a distance
\(U[-h/2, h/2]\), where \(h\) is the current lattice scale. Accept if
the shifted point meets the likelihood criterion \(c\).</p></li>
<li><p>Generate an orbit of points around the shifted \(x_0\) as a lattice
with spacing \(h\), using a doubling procedure. Stop if (a) the orbit
exceeds the unit hypercube, or (b) the recursive condition
$$max(l_{left}, l_{right}) &lt; c$$ fails, where \(l_{left}\) and
\(l_{right}\) are the likelihoods at the lattice ends.</p></li>
<li><p>Randomly select one point from the final lattice as the new live point.</p></li>
</ol><p>Choose <code>fixed_scale</code> to keep \(h\) constant, or <code>adaptive_scale</code> to update
\(h\) from inter-point distances. See References for details on tuning.</p>
    </div>
    <div class="section level2">
    <h2 id="status">Status<a class="anchor" aria-label="anchor" href="#status"></a></h2>


<p>This LRPS is experimental and has not been extensively validated across
different nested sampling problems. You are encouraged to use it, but please
exercise caution interpretting results and report any issues or unexpected
behaviour.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bou-Rabee, N., Carpenter, B., Liu, S., &amp; Oberdörster, S. (2025). The
No-Underrun Sampler: A Locally-Adaptive, Gradient-Free MCMC Method
(Version 2). arXiv. <a href="https://doi.org/10.48550/ARXIV.2501.18548" class="external-link">doi:10.48550/ARXIV.2501.18548</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other ernest_lrps:
<code><a href="mini_balls.html">mini_balls()</a></code>,
<code><a href="multi_ellipsoid.html">multi_ellipsoid()</a></code>,
<code><a href="rwmh_cube.html">rwmh_cube()</a></code>,
<code><a href="slice_rectangle.html">slice_rectangle()</a></code>,
<code><a href="unif_cube.html">unif_cube()</a></code>,
<code><a href="unif_ellipsoid.html">unif_ellipsoid()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic usage with default parameters</span></span></span>
<span class="r-in"><span><span class="va">lrps</span> <span class="op">&lt;-</span> <span class="fu">no_underrun</span><span class="op">(</span>adaptive_scale <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Conservative settings for difficult problems</span></span></span>
<span class="r-in"><span><span class="va">robust_lrps</span> <span class="op">&lt;-</span> <span class="fu">no_underrun</span><span class="op">(</span></span></span>
<span class="r-in"><span>  fixed_scale <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>  steps <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Dewsnap.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

