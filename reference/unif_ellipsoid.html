<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate samples from the spanning ellipsoid — unif_ellipsoid • ernest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate samples from the spanning ellipsoid — unif_ellipsoid"><meta name="description" content="Uses the bounding ellipsoid of live points to define the prior region for new
samples. Effective for unimodal, roughly Gaussian posteriors. The ellipsoid
is found using cluster::ellipsoidhull and its volume is inflated by a
constant enlargement factor."><meta property="og:description" content="Uses the bounding ellipsoid of live points to define the prior region for new
samples. Effective for unimodal, roughly Gaussian posteriors. The ellipsoid
is found using cluster::ellipsoidhull and its volume is inflated by a
constant enlargement factor."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ernest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/more-ernest-runs.html">More Nested Sampling Runs with Ernest</a></li>
    <li><a class="dropdown-item" href="../articles/nested-sampling-with-ernest.html">Quickstart: Nested Sampling with Ernest</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylesnap/ernest/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate samples from the spanning ellipsoid</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylesnap/ernest/blob/main/R/unif_ellipsoid.R" class="external-link"><code>R/unif_ellipsoid.R</code></a></small>
      <div class="d-none name"><code>unif_ellipsoid.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the bounding ellipsoid of live points to define the prior region for new
samples. Effective for unimodal, roughly Gaussian posteriors. The ellipsoid
is found using <a href="https://rdrr.io/pkg/cluster/man/ellipsoidhull.html" class="external-link">cluster::ellipsoidhull</a> and its volume is inflated by a
constant enlargement factor.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">unif_ellipsoid</span><span class="op">(</span>enlarge <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-enlarge">enlarge<a class="anchor" aria-label="anchor" href="#arg-enlarge"></a></dt>
<dd><p>Double, larger or equal to 1. Factor to inflate the bounding
ellipsoid's volume before sampling (see Details).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with class <code>c("unif_ellipsoid", "ernest_lrps")</code>. Use with
<code><a href="ernest_sampler.html">ernest_sampler()</a></code> to specify nested sampling behaviour.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Nested likelihood contours rarely form perfect ellipses, so sampling
from the spanning ellipsoid without enlargement may exclude valid regions.
This can bias proposals toward the ellipsoid centre and overestimate
evidence. Leaving <code>enlarge = 1</code> will trigger an alert message.</p>
<p>If <a href="https://rdrr.io/pkg/cluster/man/ellipsoidhull.html" class="external-link">cluster::ellipsoidhull</a> fails to converge, <code>unif_ellipsoid</code> falls back to
sampling from the circumscribed sphere bounding the unit hypercube.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Barbary, K. (2015). nestle: Pure Python,
MIT-Licensed Implementation of Nested Sampling Algorithms for Evaluating
Bayesian Evidence. (Computer software, Version 0.2).
<a href="https://github.com/kbarbary/nestle" class="external-link">https://github.com/kbarbary/nestle</a>.</p>
<p>Mukherjee, P., Parkinson, D., &amp; Liddle, A. R. (2006). A Nested Sampling
Algorithm for Cosmological Model Selection. The Astrophysical Journal,
638(2), L51. <a href="https://doi.org/10.1086/501068" class="external-link">https://doi.org/10.1086/501068</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other ernest_lrps:
<code><a href="rwmh_cube.html">rwmh_cube</a>()</code>,
<code><a href="unif_cube.html">unif_cube</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_run</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lrps</span> <span class="op">&lt;-</span> <span class="fu">unif_ellipsoid</span><span class="op">(</span>enlarge <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="ernest_sampler.html">ernest_sampler</a></span><span class="op">(</span><span class="va">example_run</span><span class="op">$</span><span class="va">log_lik_fn</span>, <span class="va">example_run</span><span class="op">$</span><span class="va">prior</span>, sampler <span class="op">=</span> <span class="va">lrps</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nested sampling specification <span style="color: #0000BB;">&lt;ernest_sampler&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. Points: 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ── Sampling Method </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> • uniform ellipsoid LRPS <span style="color: #0000BB;">&lt;unif_ellipsoid/ernest_lrps&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> • </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> • No. Dimensions: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> • Centre: 0.5000, 0.5000, 0.5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> • Log Volume: 1.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> • Enlargement Factor: 1.2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The default behaviour of the sampler prints an alert:</span></span></span>
<span class="r-in"><span><span class="fu">unif_ellipsoid</span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> `enlarge` is set to 1.0, which is not recommended.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> uniform ellipsoid LRPS <span style="color: #0000BB;">&lt;unif_ellipsoid/ernest_lrps&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. Dimensions: Uninitialized</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Dewsnap.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

