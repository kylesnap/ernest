[{"path":"https://kylesnap.github.io/ernest/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to ernest","title":"Contributing to ernest","text":"outlines propose change ernest. detailed discussion contributing tidyverse packages, please see development contributing guide code review principles.","code":""},{"path":"https://kylesnap.github.io/ernest/CONTRIBUTING.html","id":"lifecycle","dir":"","previous_headings":"","what":"Lifecycle","title":"Contributing to ernest","text":"Ernest initially stable state development, great deal active subsequent development envisioned.","code":""},{"path":"https://kylesnap.github.io/ernest/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to ernest","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ‚Äôll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"https://kylesnap.github.io/ernest/CONTRIBUTING.html","id":"bigger-changes","dir":"","previous_headings":"","what":"Bigger changes","title":"Contributing to ernest","text":"want make bigger change, ‚Äôs good idea first file issue make sure someone team agrees ‚Äôs needed. ‚Äôve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed). See guide create great issue advice.","code":""},{"path":"https://kylesnap.github.io/ernest/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Bigger changes","what":"Pull request process","title":"Contributing to ernest","text":"Fork package clone onto computer. haven‚Äôt done , recommend using usethis::create_from_github(\"kylesnap/ernest\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn‚Äôt pass cleanly, ‚Äôs good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e.¬†just first header). Follow style described https://style.tidyverse.org/news.html.","code":""},{"path":"https://kylesnap.github.io/ernest/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Bigger changes","what":"Code style","title":"Contributing to ernest","text":"New code follow tidyverse style guide. can use styler package apply styles, please don‚Äôt restyle code nothing PR. use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept. ernest‚Äôs tests can take run. tests can skipped setting ERNEST_EXTENDED_TESTS environment option false.","code":""},{"path":"https://kylesnap.github.io/ernest/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to ernest","text":"Please note ernest project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright ¬© 2007 Free Software Foundation, Inc.¬†<http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program‚Äìmake sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers‚Äô authors‚Äô protection, GPL clearly explains warranty free software. users‚Äô authors‚Äô sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users‚Äô freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"‚ÄúLicense‚Äù refers version 3 GNU General Public License. ‚ÄúCopyright‚Äù also means copyright-like laws apply kinds works, semiconductor masks. ‚ÄúProgram‚Äù refers copyrightable work licensed License. licensee addressed ‚Äú‚Äù. ‚ÄúLicensees‚Äù ‚Äúrecipients‚Äù may individuals organizations. ‚Äúmodify‚Äù work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called ‚Äúmodified version‚Äù earlier work work ‚Äúbased ‚Äù earlier work. ‚Äúcovered work‚Äù means either unmodified Program work based Program. ‚Äúpropagate‚Äù work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. ‚Äúconvey‚Äù work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays ‚ÄúAppropriate Legal Notices‚Äù extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"‚Äúsource code‚Äù work means preferred form work making modifications . ‚ÄúObject code‚Äù means non-source form work. ‚ÄúStandard Interface‚Äù means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. ‚ÄúSystem Libraries‚Äù executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. ‚ÄúMajor Component‚Äù, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . ‚ÄúCorresponding Source‚Äù work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work‚Äôs System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users‚Äô Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work‚Äôs users, third parties‚Äô legal rights forbid circumvention technological measures.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program‚Äôs source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 ‚Äúkeep intact notices‚Äù. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called ‚Äúaggregate‚Äù compilation resulting copyright used limit access legal rights compilation‚Äôs users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. ‚ÄúUser Product‚Äù either (1) ‚Äúconsumer product‚Äù, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, ‚Äúnormally used‚Äù refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. ‚ÄúInstallation Information‚Äù User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"‚ÄúAdditional permissions‚Äù terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered ‚Äúrestrictions‚Äù within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. ‚Äúentity transaction‚Äù transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party‚Äôs predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"‚Äúcontributor‚Äù copyright holder authorizes use License Program work Program based. work thus licensed called contributor‚Äôs ‚Äúcontributor version‚Äù. contributor‚Äôs ‚Äúessential patent claims‚Äù patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, ‚Äúcontrol‚Äù includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor‚Äôs essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, ‚Äúpatent license‚Äù express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). ‚Äúgrant‚Äù patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. ‚ÄúKnowingly relying‚Äù means actual knowledge , patent license, conveying covered work country, recipient‚Äôs use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license ‚Äúdiscriminatory‚Äù include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others‚Äô Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License ‚Äúlater version‚Äù applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy‚Äôs public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM ‚Äú‚Äù WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://kylesnap.github.io/ernest/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least ‚Äúcopyright‚Äù line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program‚Äôs commands might different; GUI interface, use ‚Äúbox‚Äù. also get employer (work programmer) school, , sign ‚Äúcopyright disclaimer‚Äù program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://kylesnap.github.io/ernest/articles/more-ernest-runs.html","id":"multimodal-bivariate-gaussian-blobs","dir":"Articles","previous_headings":"","what":"Multimodal Bivariate Gaussian ‚ÄúBlobs‚Äù","title":"More Examples with ernest","text":"Python package nestle. goal estimate evidence multimodal distribution, made mixture two well-separated bivariate Gaussian distributions. nested sampling designed handle multimodal distributions, provides good test ernest‚Äôs ability explore complicated likelihood surface. expected log-evidence, found analytically, ‚àí6.679-6.679. may use summary calculate methods examine accurate results sampling :","code":"# Log-likelihood for two Gaussian blobs sigma <- 0.1 mu1 <- c(1, 1) mu2 <- -c(1, 1) sigma_inv <- diag(2) / 0.1**2  gaussian_blobs_loglik <- function(x) {   dx1 <- -0.5 * mahalanobis(x, c(1, 1), sigma_inv, inverted = TRUE)   dx2 <- -0.5 * mahalanobis(x, c(-1, -1), sigma_inv, inverted = TRUE)   matrixStats::colLogSumExps(rbind(dx1, dx2)) }  # Uniform prior over [-5, 5] in each dimension prior <- create_uniform_prior(lower = -5, upper = 5, names = c(\"A\", \"B\"))  # Run the model blob_sampler <- ernest_sampler(   create_likelihood(vectorized_fn = gaussian_blobs_loglik),   prior,   nlive = 100,   seed = 42L ) blob_result <- generate(blob_sampler, show_progress = FALSE) summary(blob_result) #> Summary of nested sampling run: #> ‚îÄ‚îÄ Run Information ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * No. points: 100 #> * Iterations: 959 #> * Likelihood evals.: 21252 #> * Log-evidence: -6.5450 (¬± 0.2613) #> * Information: 5.527 #> * RNG seed: 42 #> ‚îÄ‚îÄ Posterior Summary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> # A tibble: 2 √ó 6 #>   variable   mean    sd median   q15   q85 #>   <chr>     <dbl> <dbl>  <dbl> <dbl> <dbl> #> 1 A        0.106   1.47  0.602 -1.11  1.12 #> 2 B        0.0479  1.49  0.615 -1.14  1.09 #> ‚îÄ‚îÄ Maximum Likelihood Estimate (MLE) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * Log-likelihood: -0.0004 #> * Original parameters: 1.0026 and 0.9990 calculate(blob_result, ndraws = 500) #> Nested sampling uncertainty estimates: #> # of Simulated Draws: 500 #> Log-volume: -15 ¬± 1.4 #> Log-evidence: -6.6 ¬± 0.24"},{"path":"https://kylesnap.github.io/ernest/articles/more-ernest-runs.html","id":"eggbox-distribution","dir":"Articles","previous_headings":"","what":"Eggbox Distribution","title":"More Examples with ernest","text":"Python package nestle. eggbox likelihood another useful test case demonstrates ernest‚Äôs ability properly integrate across multimodal likelihood surfaces.  Analytic results indicate expect log-evidence 235.895235.895. can visualise multimodal structure variable:","code":"# Log-likelihood for the eggbox function eggbox_loglik <- function(x) {   tmax <- 5.0 * pi   if (!is.matrix(x)) dim(x) <- c(1, length(x))   t <- sweep(2.0 * tmax * x, 2, tmax, \"-\")   (2.0 + cos(t[, 1] / 2.0) * cos(t[, 2] / 2.0))^5.0 }  # Uniform prior over [0, 1] in each dimension eggbox_prior <- create_uniform_prior(names = c(\"A\", \"B\")) egg_sampler <- ernest_sampler(   eggbox_loglik,   eggbox_prior,   sampler = multi_ellipsoid(),   seed = 42L ) egg_result <- generate(egg_sampler, show_progress = FALSE) #> Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display #> Warning: 'rgl.init' failed, will use the null device. #> See '?rgl.useNULL' for ways to avoid this warning. summary(egg_result) #> Summary of nested sampling run: #> ‚îÄ‚îÄ Run Information ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * No. points: 500 #> * Iterations: 5038 #> * Likelihood evals.: 11493 #> * Log-evidence: 235.9478 (¬± 0.1198) #> * Information: 6.038 #> * RNG seed: 42 #> ‚îÄ‚îÄ Posterior Summary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> # A tibble: 2 √ó 6 #>   variable  mean    sd median   q15   q85 #>   <chr>    <dbl> <dbl>  <dbl> <dbl> <dbl> #> 1 A        0.512 0.296  0.501 0.103 0.899 #> 2 B        0.502 0.297  0.500 0.102 0.899 #> ‚îÄ‚îÄ Maximum Likelihood Estimate (MLE) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * Log-likelihood: 242.9999 #> * Original parameters: 0.9000 and 0.1000 visualize(egg_result, .which = \"trace\")"},{"path":"https://kylesnap.github.io/ernest/articles/more-ernest-runs.html","id":"incorporating-data-within-likelihood-functions","dir":"Articles","previous_headings":"","what":"Incorporating Data within Likelihood Functions","title":"More Examples with ernest","text":"Nested sampling runs capable generating estimates posterior distribution. examine , provide test problem National Institute Standards Technology (NIST). certified posterior quantiles mean standard deviation y : run model, must incorporate data y likelihood function. function factory captures vector observations environment. produced function computes log-likelihood Gaussian model parameters mean mu standard deviation sigma. rely posterior R package examine posterior distribution summarising variable quantiles. better visualise correspondence expected actual values, can plot respective IQRs.","code":"y <- c(0.2, 0.1, 0.3, 0.1, 0.3, 0.1, 0.3, 0.1, 0.3, 0.1) + 1e+08 gaussian_log_lik <- function(data) {   force(data)    function(theta) {     if (theta[2] <= 0) return(-Inf)     sum(stats::dnorm(data, mean = theta[1], sd = theta[2], log = TRUE))   } }  log_lik <- gaussian_log_lik(y) prior <- create_uniform_prior(   names = c(\"mu\", \"sigma\"),   lower = c(1e+08 - 1, 0.01),   upper = c(1e+08 + 1, 1) ) nist_sampler <- ernest_sampler(log_lik, prior, seed = 42L) nist_result <- generate(nist_sampler, show_progress = FALSE) post <- as_draws(nist_result) |>   resample_draws() |>   summarise_draws(\\(x) quantile(x, probs = c(0.025, 0.5, 0.975))) post #> # A tibble: 2 √ó 4 #>   variable  `2.5%`         `50%`       `97.5%` #>   <chr>      <dbl>         <dbl>         <dbl> #> 1 mu       1.00e+8 100000000.    100000000.    #> 2 sigma    7.09e-2         0.109         0.194 #> # A tibble: 4 √ó 5 #>   variable  `2.5%`         `50%`       `97.5%` src   #>   <chr>      <dbl>         <dbl>         <dbl> <chr> #> 1 mu       1.00e+8 100000000.    100000000.    est   #> 2 sigma    7.09e-2         0.109         0.194 est   #> 3 mu       1.00e+8 100000000.    100000000.    act   #> 4 sigma    6.99e-2         0.103         0.175 act"},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"bayes-theorem-and-model-evidence","dir":"Articles","previous_headings":"","what":"Bayes‚Äô Theorem and Model Evidence","title":"Nested Sampling with ernest","text":"Bayesian inference uses probability quantify knowledge statistical model changes new data become available. Consider model MM dd unknown parameters, Œ∏\\theta. prior distribution, Pr(Œ∏|M)=œÄ(Œ∏)\\Pr(\\theta|M) = \\pi(\\theta), encodes beliefs Œ∏\\theta seeing data. Bayes‚Äô theorem describes update prior observing data DD(Skilling 2006): Pr(D|M,Œ∏)√óPr(Œ∏|M)=Pr(Œ∏|M,D)√óPr(D|M)Likelihood√óPrior=Posterior√óEvidenceùêã(Œ∏)√óœÄ(Œ∏)=P(Œ∏)√óùêô \\begin{aligned}   \\Pr(D|M,\\theta) \\times Pr(\\theta|M) &= \\Pr(\\theta|M,D) \\times \\Pr(D|M) \\\\   \\text{Likelihood} \\times \\text{Prior} &= \\text{Posterior} \\times \\text{Evidence} \\\\   \\mathbf{L}(\\theta) \\times \\pi(\\theta) &= P(\\theta) \\times \\mathbf{Z} \\end{aligned} likelihood function, ùêã(Œ∏)\\mathbf{L}(\\theta), measures probable data DD , given model parameter value. Bayesian computation uses P(Œ∏)P(\\theta) ùêã(Œ∏)\\mathbf{L}(\\theta) estimate posterior, P(Œ∏)P(\\theta), reflects updated knowledge Œ∏\\theta observing DD, model evidence, ùêô\\mathbf{Z}. , ùêô\\mathbf{Z} normalizing constant posterior, ensuring P(Œ∏)P(\\theta) integrates 1. However, evidence also plays central role Bayesian model selection: rearranging Bayes‚Äô theorem, can express ùêô\\mathbf{Z} marginal likelihood, found integrating ùêã(Œ∏)\\mathbf{L}(\\theta) possible values parameter space Œ∏‚ààŒò\\theta \\\\Theta: ùêô=‚à´Œ∏‚ààŒòùêã(Œ∏)œÄ(Œ∏)dŒ∏   \\mathbf{Z} = \\int_{\\theta \\\\Theta} \\mathbf{L}(\\theta) \\pi(\\theta) d\\theta ùêô\\mathbf{Z} represents probability observing data, averaged across possible parameter values. provides powerful method compare models: two models M1M_1 M2M_2 explaining data, relative plausibility expressed posterior odds, factor prior odds ratio evidences: Pr(Œ∏|M1,D)Pr(Œ∏|M2,D)=Pr(Œ∏|M1)Pr(Œ∏|M2)√óPr(D|M1)Pr(D|M2)   \\frac{\\Pr(\\theta|M_1, D)}{\\Pr(\\theta|M_2, D)} = \\frac{\\Pr(\\theta|M_1)}{\\Pr(\\theta|M_2)} \\times \\frac{\\Pr(D|M_1)}{\\Pr(D|M_2)} ratio, called Bayes factor (Jeffreys 1998), quantifies support one model another. Bayes factors related tools, posterior model probabilities (Gronau et al., n.d.), central model selection. key challenge calculating estimating model evidence comes need perform integration highly-dimensional parameter space: even basic models used statisticians can tens parameters, hierarchical models can hundreds thousands. makes finding ùêô\\mathbf{Z} direct integration computationally unfeasible. computational complexity explains evidence often neglected Bayesian computation, methods instead focusing estimating posterior. Posterior estimates generated methods Markov chain Monte Carlo (MCMC) (Metropolis et al. 1953) can used estimate ùêô\\mathbf{Z} techniques bridge sampling (Gronau et al., n.d.). However, techniques typically highly sensitive sampling variation posterior estimate, requiring one provide dense samples conduct sensitivity analyses produced evidence estimates (B√ºrkner 2017).","code":""},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"estimating-evidence-with-nested-sampling","dir":"Articles","previous_headings":"","what":"Estimating Evidence with Nested Sampling","title":"Nested Sampling with ernest","text":"Nested sampling Bayesian computational algorithm estimating model evidence integral, introduced John Skilling Skilling (2007). goal divide parameter space Œò\\Theta series nested contours shells defined likelihood values. take fixed NN number samples Œò\\Theta ordered L(Œ∏1)L(\\theta_1) point sample worst likelihood, can express volume VV Œò\\Theta contains points likelihood greater ùêã(Œ∏1)=L1\\mathbf{L}(\\theta_1) = L_1 Buchner (2023): V(L1)=Pr(ùêã(Œ∏)>L1)=‚à´ùêã(Œ∏)>L1œÄ(Œ∏)dŒ∏ \\begin{aligned}     V(L_1) &= \\Pr(\\mathbf{L}(\\theta) > L_1) \\\\     &= \\int_{\\mathbf{L}(\\theta) > L_1} \\pi(\\theta) d\\theta \\end{aligned} can define shell‚Äôs volumes similarly. create great many shells across parameter space, can rewrite evidence integral (Skilling 2006): ùêô=‚à´01L(Vi)dV\\begin{equation}     \\mathbf{Z} = \\int_{0}^{1} L(V_i) d V     \\label{eq:evid_ns} \\end{equation} estimate volume shell Vi=V(Li)V_i = V(L_i), can note sequence V1,V2,‚Ä¶,VNV_1, V_2, \\ldots, V_N strictly decreasing. probability integral transform survival function Pr(ùêã(Œ∏)>L1)\\Pr(\\mathbf{L}(\\theta) > L_1), volumes follow standard uniform distribution. , infer NN samples used construct nested shells divide parameter space uniformly distributed volumes along likelihood function. allows us use uniform order statistics estimate volume belonging worst sampled point Vi‚àºBeta(N,1)V_i \\sim \\text{Beta}(N, 1)(Skilling 2004).","code":""},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"nested-sampling-with-ernest","dir":"Articles","previous_headings":"","what":"Nested Sampling with ernest","title":"Nested Sampling with ernest","text":"Nested sampling creates series shells generating ..d. sample prior, repeatedly replacing worst point sample new point likelihood-restricted prior sampler (LRPS). iteration ii, worst point replaced new, independently sampled point, ùêã(Œ∏new)>ùêã(Œ∏min)\\mathbf{L}(\\theta_{new}) > \\mathbf{L}(\\theta_{min}). replacement slightly contracts parameter space, estimate Vi+1/Vi‚àºBeta(N,1)V_{+1}/V_i \\sim \\text{Beta}(N,1) V0=1V_0 = 1. sampled bulk posterior, can estimate ùêô\\mathbf{Z} analytically. demonstrate nested sampling ernest, fit well-known model seizure counts patients epilepsy change exposed anti-convulsant therapy (Thall Vail 1990). data, available brms (B√ºrkner 2017) R package, fit using Poisson model log link:","code":"> fit1 <- brm( +   count ~ zAge + zBase * Trt, +   prior = set_prior(\"normal(0, 2.5)\", class = \"b\") + +     set_prior(\"normal(0, 2.5)\", class = \"Intercept\"), +   data = epilepsy, +   family = poisson() + ) > fit1 Family: poisson  Links: mu = log  Formula: count ~ zAge + zBase * Trt    Data: epilepsy (Number of observations: 236)    Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;          total post-warmup draws = 4000  Regression Coefficients:            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS Intercept      1.94      0.04     1.86     2.01 1.00     3221     2717 zAge           0.15      0.03     0.10     0.20 1.00     3405     2480 zBase          0.57      0.02     0.52     0.62 1.00     2541     2374 Trt1          -0.20      0.05    -0.31    -0.09 1.00     3065     2858 zBase:Trt1     0.05      0.03    -0.01     0.11 1.00     2482     2248"},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"initialization","dir":"Articles","previous_headings":"Nested Sampling with ernest","what":"Initialization","title":"Nested Sampling with ernest","text":"Bayesian computation, nested sampling requires likelihood function prior model parameters. ernest, done create_likelihood create_prior functions. also need select LRPS method used run.","code":""},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"likelihood","dir":"Articles","previous_headings":"Nested Sampling with ernest > Initialization","what":"Likelihood","title":"Nested Sampling with ernest","text":"ernest, model likelihoods provided log-density functions, take vector parameter values return corresponding log-likelihood. details extracting creating likelihood functions models, see documentation enrichwith (Kosmidis 2020) tfprobability (Keydana 2022) packages. following code loads epilepsy dataset prepares design matrix response vector use likelihood function. first build simple function calculating log-density model. poisson_log_lik function factory takes design matrix response vector returns function one argument. function expects vector five regression coefficients uses compute linear predictor, apply inverse link, return sum log-likelihoods given observed data. create_likelihood wraps user provided log-likelihood functions, ensuring always returns finite double value -Inf used within run. default, ernest warn user non-compliant values produced log-likelihood function, replacing -Inf. improved performance, especially high dimensions, ernest allows provide vectorized log-likelihood function. function accepts matrix parameter (row sample) returns vector log-likelihoods. future, ernest take advantage functions improve efficiency specific LRPS methods. Regardless whether provide vectorized scalar likelihood function, create_likelihood allows us provide parameter matrices functions evaluate multiple log-likelihoods simultaneously.","code":"data(\"epilepsy\") frame <- model.frame(count ~ zAge + zBase * Trt, epilepsy) X <- model.matrix(count ~ zAge + zBase * Trt, epilepsy) Y <- model.response(frame) poisson_log_lik <- function(predictors, response, link = \"log\") {   force(predictors)   force(response)   link <- make.link(link)      function(theta) {     eta <- predictors %*% theta     mu <- link$linkinv(eta)     sum(dpois(response, lambda = mu, log = TRUE))   } }  epilepsy_log_lik <- create_likelihood(poisson_log_lik(X, Y)) epilepsy_log_lik #> Scalar Log-likelihood Function #> function (theta)  #> { #>     eta <- predictors %*% theta #>     mu <- link$linkinv(eta) #>     sum(dpois(response, lambda = mu, log = TRUE)) #> }  epilepsy_log_lik(c(1.94, 0.15, 0.57, -0.20, 0.05)) #> [1] -859.9659 epilepsy_log_lik(c(1.94, 0.15, 0.57, -0.20, Inf)) #> Warning: Replacing `NaN` with `-Inf`. #> [1] -Inf poisson_vec_lik <- function(predictors, response, link = \"log\") {   force(predictors)   force(response)   link <- make.link(link)    function(theta_mat) {     eta_mat <- predictors %*% t(theta_mat)     mu_mat <- link$linkinv(eta_mat)     colSums(apply(mu_mat, 2, \\(col) dpois(response, lambda = col, log = TRUE)))   } }  epilepsy_vec_lik <- create_likelihood(vectorized_fn = poisson_vec_lik(X, Y)) epilepsy_vec_lik #> Vectorized Log-likelihood Function #> function (theta_mat)  #> { #>     eta_mat <- predictors %*% t(theta_mat) #>     mu_mat <- link$linkinv(eta_mat) #>     colSums(apply(mu_mat, 2, function(col) dpois(response, lambda = col,  #>         log = TRUE))) #> } theta_mat <- matrix(   c(1.94, 0.15, 0.57, -0.20, 0.05, 1.94, 0.0, 0.0, 0.0, 0.0),   byrow = TRUE,   nrow = 2 ) epilepsy_vec_lik(theta_mat) #> [1]  -859.9659 -1668.7106 epilepsy_log_lik(theta_mat) #> [1]  -859.9659 -1668.7106"},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"prior-distributions","dir":"Articles","previous_headings":"Nested Sampling with ernest > Initialization","what":"Prior Distributions","title":"Nested Sampling with ernest","text":"Like nested sampling software, ernest performs sampling within unit hypercube, transforms points original parameter space using prior transformation function. ernest, use create_prior function one specializations specify prior transformation well dimensionality model. Priors can constructed custom transformation function vector unique parameter names. Functions take vector values within interval (0,1)(0, 1) return -length vector scale original parameter space. marginals independent, can use quantile functions construct transformation. following example defines custom prior element independently distributed normal standard deviation 2.5. resulting object ernest_prior, contains tested transformation function metadata sampler. Like create_likelihood, can use vectorized_fn argument provide vectorized transformation function. accepts matrix unit hypercube samples returns matrix points original parameter space. ernest also provides built-helpers common priors, parameter spaces defined marginally independent (possibly truncated) normal distributions. can use produce prior model, taking advantage vectorized prior transformation function:","code":"coef_names <- c(\"Intercept\", \"zAge\", \"zBase\", \"Trt1\", \"zBase:Trt1\")  norm_transform <- function(unit) {   qnorm(unit, sd = 2.5) } custom_prior <- create_prior(norm_transform, names = coef_names) custom_prior #> custom prior distribution with 5 dimensions (Intercept, zAge, zBase, Trt1, and zBase:Trt1) model_prior <- create_normal_prior(names = coef_names, sd = 2.5) model_prior #> normal prior distribution with 5 dimensions (Intercept, zAge, zBase, Trt1, and zBase:Trt1)"},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"likelihood-restricted-prior-sampler","dir":"Articles","previous_headings":"Nested Sampling with ernest > Initialization","what":"Likelihood-Restricted Prior Sampler","title":"Nested Sampling with ernest","text":"likelihood-restricted prior sampler (LRPS) proposes new points prior, subject constraint likelihood exceeds given threshold. choice LRPS critical efficiency robustness nested sampling, determines well algorithm can explore complex multimodal likelihood surfaces. ernest provides several built-LRPS implementations, different strategies exploring constrained prior region. samplers S3 objects inheriting ernest_lrps, specified along likelihood prior objects initializing run. Briefly, options : unif_cube(): Uniform rejection sampling entire prior. highly inefficient problems, useful testing debugging. unif_ellipsoid(enlarge = ...): Uniform sampling within bounding ellipsoid around live points, optionally enlarged. efficient unimodal, roughly elliptical posteriors. multi_ellipsoid(enlarge = ...): Uniform sampling within union multiple ellipsoids, can better handle multimodal non-convex regions. slice_rectangle(enlarge = ...): Slice sampling within bounding rectangle, optional enlargement. can effective high-dimensional correlated posteriors. rwmh_cube(steps = ..., target_acceptance = ...): Random-walk Metropolis-Hastings within unit hypercube, configurable step count acceptance target. Select configure LRPS based geometry complexity model‚Äôs likelihood surface. problems, multi_ellipsoid rwmh_cube recommended starting points. can configure providing sampler adjusting arguments: LRPS interface extensible, allowing advanced users implement custom samplers following S3 conventions described package‚Äôs internal documentation.","code":"multi_ellipsoid() #> Uniform sampling within bounding ellipsoids (enlarged by 1.25): #> # Dimensions: Uninitialized #> # Calls since last update: 0 #>  multi_ellipsoid(enlarge = 1.5) #> Uniform sampling within bounding ellipsoids (enlarged by 1.5): #> # Dimensions: Uninitialized #> # Calls since last update: 0 #>   rwmh_cube() #> 25-step random walk sampling (acceptance target = 50.0%): #> # Dimensions: Uninitialized #> # Calls since last update: 0 #>  rwmh_cube(steps = 30, target_acceptance = 0.4) #> 30-step random walk sampling (acceptance target = 40.0%): #> # Dimensions: Uninitialized #> # Calls since last update: 0 #>"},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"generating-samples","dir":"Articles","previous_headings":"Nested Sampling with ernest","what":"Generating Samples","title":"Nested Sampling with ernest","text":"initialize sampler, call ernest_sampler likelihood, prior, LRPS objects. creates ernest_sampler object, contains (among metadata) initial live set points ordered likelihood values. Calling function also tests likelihood prior transformation functions reports unexpected behaviour. generate function runs nested sampling loop controls run stop. example, can perform 1000 sampling iterations setting max_iterations: generate produces ernest_run object, inherits ernest_sampler contains data describing run. recommended overwrite values within object, can explore internals. example, ernest calculates contribution shell final log-evidence estimate wi=f(Li)*ŒîVi w_i = f(L_i) * \\Delta V_i ŒîVi=Vi‚àíVi‚àí1\\Delta V_i = V_i - V_{-1} f(Li)=(Li‚àí1+Li)/2f(L_i) = (L_{-1} + L_i)/2. Summing unnormalized log-weights gives model evidence estimate, can view accessing within run_1k object:","code":"sampler <- ernest_sampler(epilepsy_log_lik, model_prior, sampler = rwmh_cube(), nlive = 300, seed = 42) sampler #> Nested sampling run specification: #> * No. points: 300 #> * Sampling method: 25-step random walk sampling (acceptance target = 50.0%) #> * Prior: normal prior distribution with 5 dimensions (Intercept, zAge, zBase, #> Trt1, and zBase:Trt1) run_1k <- generate(sampler, max_iterations = 1000, show_progress = FALSE) run_1k #> Nested sampling run: #> * No. points: 300 #> * Sampling method: 25-step random walk sampling (acceptance target = 50.0%) #> * Prior: normal prior distribution with 5 dimensions (Intercept, zAge, zBase, #> Trt1, and zBase:Trt1) #> ‚îÄ‚îÄ Results ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * Iterations: 1000 #> * Likelihood evals.: 16453 #> * Log-evidence: -1031.2631 (¬± 23.6401) #> * Information: 558.9 run_1k$weights$log_weight |> summary() #>       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.  #> -1.359e+21 -1.855e+04 -8.577e+03 -1.045e+18 -5.655e+03 -1.031e+03"},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"properties-of-nested-sampling-runs","dir":"Articles","previous_headings":"","what":"Properties of Nested Sampling Runs","title":"Nested Sampling with ernest","text":"Beyond estimating model evidence, nested sampling substantially different Bayesian methods like MCMC. Understanding differences important knowing use nested sampling analyses. section additionally demonstrates can use ernest_run‚Äôs S3 methods better understand run‚Äôs results.","code":""},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"robustness","dir":"Articles","previous_headings":"Properties of Nested Sampling Runs","what":"Robustness","title":"Nested Sampling with ernest","text":"Traversing integrating arbitrary parameter space Œò\\Theta challenging, especially due high dimensionality‚Äîmain motivation nested sampling (Skilling 2004). Even low dimensions, Œò\\Theta may features non-convexity multimodality hinder exploration (Buchner 2023). pathologies often confound MCMC related Monte Carlo methods (Freeman Dale 2013). Nested sampling avoids many problems: generating samples entire prior region using LRPS, less sensitive local behaviour can globally explore parameter space, rather getting stuck features likelihood, local maxima.","code":""},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"complexity","dir":"Articles","previous_headings":"Properties of Nested Sampling Runs","what":"Complexity","title":"Nested Sampling with ernest","text":"Nested sampling computationally intensive, mainly due need explore entire parameter space. exact complexity run problem-specific, depending LRPS method shape likelihood-restricted prior step; however, Skilling (2009) notes number iterations needed successfully integrate posterior proportional HNHN, HH KL divergence posterior prior: H=DKL(P(Œ∏)|œÄ(Œ∏))=‚àëŒòP(Œ∏)logP(Œ∏)œÄ(Œ∏) H = D_\\text{KL}(P(\\theta) | \\pi(\\theta)) = \\sum_{ \\Theta } P(\\theta) \\, \\log \\frac{ P(\\theta) }{ \\pi(\\theta) } gives rough estimate complexity; work refines specific likelihoods priors Skilling (2009). practice, uninformative weakly informative priors greatly increase run time, iterations spent traversing uninformative regions.","code":""},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"stopping-criteria","dir":"Articles","previous_headings":"Properties of Nested Sampling Runs","what":"Stopping Criteria","title":"Nested Sampling with ernest","text":"can use naive methods stop nested sampling run, setting max_iterations max_evaluations calling generate. Fortunately, nested sampling provides nuanced method terminating run. iteration, can estimate amount evidence remains un-integrated (Speagle 2020): ŒîùêôiÃÇ=LmaxVi\\begin{equation}     \\Delta \\hat{\\mathbf{Z}_{}} = L_{max} V_i \\end{equation} estimate assumes remaining space can represented single shell likelihood LmaxL_{max} volume ViV_i. run continues, contribution shrinks. small relative current evidence estimate, run can considered sucessfully traversed informative region parameter space. Numerically, represented log-ratio (Skilling 2006): Œîlnœµi=ln(ùêôiÃÇ‚àíŒîùêôiÃÇ)‚àílnùêôiÃÇ\\begin{equation}     \\Delta \\ln{\\epsilon_i} = \\ln{(\\hat{\\mathbf{Z}_i} - \\Delta \\hat{\\mathbf{Z}_i})} - \\ln{\\hat{\\mathbf{Z}_i}} \\end{equation} Since ŒîùêôiÃÇ\\Delta \\hat{\\mathbf{Z}_i} tends overestimate remaining contribution, criterion results iterations strictly necessary, allowing sampler better detect irregularities likelihood surface. ernest, set criterion min_logz argument generate. default, generate produce samples min_logz falls 0.050.05. can call generate earlier-produced run_1k object continue sampling run satisfies Œîlnœµi<0.05\\Delta \\ln{\\epsilon_i} < 0.05.","code":"run <- generate(run_1k, show_progress = FALSE) run #> Nested sampling run: #> * No. points: 300 #> * Sampling method: 25-step random walk sampling (acceptance target = 50.0%) #> * Prior: normal prior distribution with 5 dimensions (Intercept, zAge, zBase, #> Trt1, and zBase:Trt1) #> ‚îÄ‚îÄ Results ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * Iterations: 7732 #> * Likelihood evals.: 184753 #> * Log-evidence: -882.7322 (¬± 0.3166) #> * Information: 20.53"},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"uncertainty","dir":"Articles","previous_headings":"Properties of Nested Sampling Runs","what":"Uncertainty","title":"Nested Sampling with ernest","text":"Evidence estimates produced nested sampling two main sources error: () error ŒîVi\\Delta V_i, due uncertainty assigning volumes shells P(Œ∏)P(\\theta); (b) error f(Li)f(L_i), using point estimate likelihood across shell. key advantage nested sampling sources error can estimated without repeating sampling procedure. ernest provides methods estimating uncertainty due ŒîVi\\Delta V_i experimental analytic means. former, ernest reports ‚Äúcheap‚Äôn‚Äôcheerful‚Äù (Skilling 2009) approximation variance log-evidence estimate: ùêï(lnùêôÃÇ)=HÃÇN \\mathbf{V}(\\hat{\\ln \\mathbf{Z}}) = \\sqrt{\\frac{\\hat{H}}{N}} HÃÇ\\hat{H} estimated information, calculated nested sampling run: HÃÇ=‚àílnùêô+1ùêô‚à´01ùêã(Œ∏)lnùêã(Œ∏)dx \\hat{H} = -\\ln{\\mathbf{Z}} + \\frac{1}{\\mathbf{Z}} \\int_0^1 \\mathbf{L}(\\theta) \\ln{\\mathbf{L}(\\theta)}dx can view uncertainty calling summary ernest_run object. can additionally visualize log weights iteration changed across run using plot method.  Additionally, since shrinkage ViV_i iterations follows Beta(N,1)\\text{Beta}(N, 1), relatively inexpensive simulate different shrinkage sequences create bootstrapped statistic. ernest, can using calculate, similar plot method.  Uncertainty within LiL_i harder quantify, may arise systematic errors LRPS. future, ernest allow creating simulated runs bootstrapping: run split NN threads (one live point), regrouped synthetic runs size NN replacement (Higson et al. 2018). Currently, users interested bootstrapping ernest_run objects referred nestcheck python package (Higson et al. 2019).","code":"summary(run) #> Summary of nested sampling run: #> ‚îÄ‚îÄ Run Information ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * No. points: 300 #> * Iterations: 7732 #> * Likelihood evals.: 184753 #> * Log-evidence: -882.7322 (¬± 0.3166) #> * Information: 20.53 #> * RNG seed: 42 #> ‚îÄ‚îÄ Posterior Summary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> # A tibble: 5 √ó 6 #>   variable      mean    sd  median    q15   q85 #>   <chr>        <dbl> <dbl>   <dbl>  <dbl> <dbl> #> 1 Intercept   1.39   1.25   1.89    0.550 2.01  #> 2 zAge        0.125  0.851  0.148  -0.127 0.404 #> 3 zBase       0.463  0.801  0.569   0.223 0.766 #> 4 Trt1       -0.186  1.08  -0.191  -0.626 0.374 #> 5 zBase:Trt1  0.0165 0.840  0.0468 -0.270 0.332 #> ‚îÄ‚îÄ Maximum Likelihood Estimate (MLE) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * Log-likelihood: -859.9761 #> * Original parameters: 1.9363, 0.1484, 0.5672, -0.1946, and 0.0527 plot(run, which = c(\"weight\", \"likelihood\")) sim_run <- calculate(run, ndraws = 1000) sim_run #> Nested sampling uncertainty estimates: #> # of Simulated Draws: 1000 #> Log-volume: -32 ¬± 1.3 #> Log-evidence: -883 ¬± 0.26 plot(sim_run, which = c(\"weight\", \"likelihood\"))"},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"posterior-distributions","dir":"Articles","previous_headings":"Properties of Nested Sampling Runs","what":"Posterior Distributions","title":"Nested Sampling with ernest","text":"Nested sampling, targeting model evidence, can also produce estimated posterior distribution side-effect. point log-weight discarded live set, can estimate posterior using dead set points, weighted importance weights: pi‚âàwi‚àë‚àÄiwi‚âàwiZÃÇ\\begin{align}     p_i &\\approx \\frac{w_i}{\\sum_{\\forall }{w_i}} \\\\     &\\approx \\frac{w_i}{\\hat{Z}} \\end{align} ernest, posterior can extracted using as_draws object. reweighting sample importance weights, can summarize posterior using posterior package, produce visualizations.","code":"as_draws(run) |>   resample_draws() |>   summarise_draws() #> # A tibble: 5 √ó 10 #>   variable      mean  median     sd    mad       q5     q95  rhat ess_bulk #>   <chr>        <dbl>   <dbl>  <dbl>  <dbl>    <dbl>   <dbl> <dbl>    <dbl> #> 1 Intercept   1.94    1.94   0.0364 0.0369  1.87     2.00    1.11    1609. #> 2 zAge        0.147   0.147  0.0255 0.0256  0.106    0.190   1.13    1718. #> 3 zBase       0.570   0.571  0.0234 0.0243  0.532    0.609   1.07    1735. #> 4 Trt1       -0.198  -0.199  0.0506 0.0497 -0.279   -0.112   1.08    1518. #> 5 zBase:Trt1  0.0494  0.0488 0.0282 0.0287  0.00371  0.0951  1.08    1664. #> # ‚Ñπ 1 more variable: ess_tail <dbl> visualize(run, .which = \"trace\") visualize(run, -Intercept, .which = \"density\")"},{"path":"https://kylesnap.github.io/ernest/articles/nested-sampling-with-ernest.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Nested Sampling with ernest","text":"Nested sampling powerful method estimating model evidence (ZZ) directly proposed model, rather treating -product posterior estimation. procedure yields several provides features may appealing MCMC certain scenarios: Runs can handle complexities likelihood surface, can halt clearly defined criteria, can produce error estimates without replicating original sampling process. ernest provides R-based implementation nested sampling, along methods visualizing processing results. information ernest available documentation.","code":""},{"path":"https://kylesnap.github.io/ernest/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kyle Dewsnap. Author, maintainer.","code":""},{"path":"https://kylesnap.github.io/ernest/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Skilling J (2004). ‚ÄúNested Sampling.‚Äù AIP Conference Proceedings, 735(1), 395‚Äì405. doi:10.1063/1.1835238. Skilling J (2006). ‚ÄúNested Sampling General Bayesian Computation.‚Äù Bayesian Analysis, 1(4), 833‚Äì859. doi:10.1214/06-BA127.","code":"@Article{,   title = {Nested Sampling},   author = {John Skilling},   journal = {AIP Conference Proceedings},   year = {2004},   volume = {735},   number = {1},   pages = {395‚Äì405},   doi = {10.1063/1.1835238}, } @Article{,   title = {Nested Sampling for General Bayesian Computation},   author = {John Skilling},   journal = {Bayesian Analysis},   year = {2006},   volume = {1},   number = {4},   pages = {833‚Äì859},   doi = {10.1214/06-BA127}, }"},{"path":"https://kylesnap.github.io/ernest/index.html","id":"a-toolkit-for-nested-sampling","dir":"","previous_headings":"","what":"A Toolkit for Nested Sampling","title":"A Toolkit for Nested Sampling","text":"ernest comprehensive toolkit nested sampling (NS), algorithm estimating statistical model‚Äôs Bayesian evidence posterior distribution. provides S3 objects methods make nested sampling accessible, flexible, robust within R environment.","code":""},{"path":"https://kylesnap.github.io/ernest/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"A Toolkit for Nested Sampling","text":"Install development version ernest GitHub : ‚Äôll also need working C++ compiler. get : Windows, install Rtools. Mac, install Xcode app store. Linux,¬†sudo apt-get install r-base-dev¬†similar.","code":"# install.packages(\"devtools\") devtools::install_github(\"kylesnap/ernest\")"},{"path":"https://kylesnap.github.io/ernest/index.html","id":"why-use-ernest","dir":"","previous_headings":"","what":"Why use ernest?","title":"A Toolkit for Nested Sampling","text":"Often, statisticians faced multiple competing models intend describe estimate given data set. One way compare models evaluating model evidence (also called marginal likelihood), found integrating model‚Äôs likelihood function across possible values parameters. Bayesian inference, evidence represents parameter-independent probability data occurring given model‚Äîcalculating comparing evidence values across different models, using Bayes factors, plays important role Bayesian inference. Calculating evidence directly challenging, requires evaluating high-dimensional integral parameter space. Nested sampling estimates integral dividing space series small volumes. starts drawing points prior ranking likelihood. least likely points discarded replaced new samples restricted likelihood regions, gradually compressing search space. round discarding shrinks explored volume predictable way, helping approximate integral. approach estimating evidence offers several advantages methods like Markov chain Monte Carlo (MCMC): Robustness: NS handles complex likelihood surfaces otherwise difficult traverse, multiple modes discontinuities. Posterior inference: run, discarded samples can weighted approximate model‚Äôs posterior distribution. Natural stopping criterion: NS can estimate amount evidence left within unexplored prior volume, can stop sampling amount gets trivially small. Tractable uncertainty estimates: shrinkage iteration follows uniform order statistic, uncertainty can simulated using results single run. ernest‚Äôs implementation NS offers R users several benefits: Native R implementation: John Skilling‚Äôs NS algorithm implemented R, Python Fortran dependencies. (C++ used implement included likelihood samplers improve run-time efficiency). Type- size-safety: ernest helps ensure user provides likelihood functions prior specifications meet requirements NS algorithm. Familiar methods: Sampler specifications results stored S3 objects. Start continue NS run generate(), review results summary(), simulate estimation error calculate(). Powerful visualizations: Plot evidence estimates analyse posterior distributions using ggplot2 posterior.","code":""},{"path":"https://kylesnap.github.io/ernest/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"A Toolkit for Nested Sampling","text":"advanced usage, including custom priors hierarchical models, see package vignettes.","code":"library(ernest)  # Define a prior (i.i.d. multivariate uniform) prior <- create_uniform_prior(names = c(\"x\", \"y\", \"z\"), lower = -10, upper = 10)  # Define a log-likelihood function (multivariate normal) log_lik_mvn <- function(theta) {   n_dim <- 3   sigma <- diag(0.95, nrow = 3) # Covariance matrix   det_sigma <- log(det(sigma))   prec <- solve(sigma) # Precision matrix (Sigma^-1)   log_norm <- -0.5 * (log(2 * pi) * n_dim + det_sigma) # Normalization for MVG    drop(-0.5 * crossprod(theta, crossprod(prec, theta)) + log_norm) }  # Set up and run the sampler sampler <- ernest_sampler(   log_lik_mvn,   prior = prior,   nlive = 500 ) run <- generate(sampler, show_progress = FALSE)  # Summarize and visualize results summary(run) #> Summary of nested sampling run: #> ‚îÄ‚îÄ Run Information ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * No. points: 500 #> * Iterations: 4633 #> * Likelihood evals.: 101352 #> * Log-evidence: -8.9259 (¬± 0.1137) #> * Information: 4.732 #> ‚îÄ‚îÄ Posterior Summary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> # A tibble: 3 √ó 6 #>   variable      mean    sd   median   q15   q85 #>   <chr>        <dbl> <dbl>    <dbl> <dbl> <dbl> #> 1 x        -0.0472    2.80  0.00714 -2.03  1.85 #> 2 y        -0.000385  2.81 -0.00925 -1.89  1.87 #> 3 z        -0.111     2.75 -0.0345  -2.01  1.78 #> ‚îÄ‚îÄ Maximum Likelihood Estimate (MLE) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * Log-likelihood: -2.6811 #> * Original parameters: -0.0116, -0.0448, and -0.0105 plot(run, which = \"evidence\") visualize(run, x, .which = \"trace\")"},{"path":"https://kylesnap.github.io/ernest/index.html","id":"prior-work","dir":"","previous_headings":"","what":"Prior Work","title":"A Toolkit for Nested Sampling","text":"NS implemented many languages. non-exhaustive list popular NS implementations adapted Fowlie (2021): Python: nestle dynesty C++: DIAMONDS DNest4* Fortran: MultiNest* PolyChord (* Indicates software includes R interface.) ernest‚Äôs design, API, NS implementation based nestle package, inspiration dynesty. nestcheck Python package provides routines error estimation diagnostic plotting nested sampling runs. Several ernest‚Äôs methods based work.","code":""},{"path":"https://kylesnap.github.io/ernest/index.html","id":"citing-ernest","dir":"","previous_headings":"","what":"Citing ernest","title":"A Toolkit for Nested Sampling","text":"using ernest, please least include following citations: Dewsnap K. (2025). ‚Äúernest: Toolkit Nested Sampling.‚Äù R package version XXX, <URL: (https://kylesnap.github.io/ernest/)> Skilling, J. (2006). Nested Sampling General Bayesian Computation. Bayesian Analysis, 1(4), 833‚Äì859. <DOI: https://doi.org/10.1214/06-BA127> Buchner, J. (2023). Nested Sampling Methods. Statistics Surveys, 17, 169‚Äì215. <DOI: https://doi.org/10.1214/23-SS144> Additional citations ernest can found package‚Äôs vignettes within function documentation.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/as_draws.ernest_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform nested sampling runs to draws objects ‚Äî as_draws.ernest_run","title":"Transform nested sampling runs to draws objects ‚Äî as_draws.ernest_run","text":"Access posterior sample weights nested sampling run object supported posterior package.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/as_draws.ernest_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform nested sampling runs to draws objects ‚Äî as_draws.ernest_run","text":"","code":"# S3 method for class 'ernest_run' as_draws(x, units = c(\"original\", \"unit_cube\"), radial = FALSE, ...)  # S3 method for class 'ernest_run' as_draws_matrix(x, units = c(\"original\", \"unit_cube\"), radial = FALSE, ...)  # S3 method for class 'ernest_run' as_draws_rvars(x, units = c(\"original\", \"unit_cube\"), radial = FALSE, ...)"},{"path":"https://kylesnap.github.io/ernest/reference/as_draws.ernest_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform nested sampling runs to draws objects ‚Äî as_draws.ernest_run","text":"x [ernest_run] Results nested sampling run. units [character(1)] scale sampled points: \"original\": Points scale prior space. \"unit_cube\": Points (0, 1) unit hypercube scale. radial [logical(1)] TRUE, returns additional column .radial containing radial coordinate (.e., Euclidean norm) sampled point. ... dots future extensions must empty.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/as_draws.ernest_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform nested sampling runs to draws objects ‚Äî as_draws.ernest_run","text":"posterior::draws_matrix() posterior::draws_rvars()  object containing posterior samples nested sampling run, hidden .weights column containing importance weights sample.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/as_draws.ernest_run.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Transform nested sampling runs to draws objects ‚Äî as_draws.ernest_run","text":"produce weighted posterior sample, use posterior::resample_draws() reweigh object as_draws using importance weights.","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/as_draws.ernest_run.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform nested sampling runs to draws objects ‚Äî as_draws.ernest_run","text":"","code":"library(posterior) #> This is posterior version 1.6.1 #>  #> Attaching package: ‚Äòposterior‚Äô #> The following objects are masked from ‚Äòpackage:stats‚Äô: #>  #>     mad, sd, var #> The following objects are masked from ‚Äòpackage:base‚Äô: #>  #>     %in%, match data(example_run)  # View importance weights dm <- as_draws(example_run) weights(dm) |> head() #> [1] 1.319439e-63 5.734565e-61 6.105971e-59 1.221066e-58 8.797702e-58 #> [6] 2.620611e-56  # Summarise points after resampling dm |>   resample_draws() |>   summarize_draws() #> # A tibble: 3 √ó 10 #>   variable     mean   median    sd   mad    q5   q95  rhat ess_bulk ess_tail #>   <chr>       <dbl>    <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>    <dbl> #> 1 x        -0.0254  -0.0388  0.964 0.952 -1.63  1.55  1.19    4202.     13.0 #> 2 y         0.00483  0.00671 0.980 0.974 -1.60  1.60  1.19    4455.     12.6 #> 3 z         0.0129   0.0320  0.987 0.968 -1.62  1.63  1.19    4113.     12.5  # View the radial coordinate in unit space over the run dm_rad <- as_draws_rvars(   example_run,   units = \"unit_cube\",   radial = TRUE ) plot(x = draws_of(dm_rad$.radial))"},{"path":"https://kylesnap.github.io/ernest/reference/calculate.ernest_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Evidence using a Nested Sampling Run ‚Äî calculate.ernest_run","title":"Estimate Evidence using a Nested Sampling Run ‚Äî calculate.ernest_run","text":"Computes evidence related quantities nested sampling run, optionally simulating volumes nested likelihood shell.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/calculate.ernest_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Evidence using a Nested Sampling Run ‚Äî calculate.ernest_run","text":"","code":"# S3 method for class 'ernest_run' calculate(x, ndraws = 1000L, ...)"},{"path":"https://kylesnap.github.io/ernest/reference/calculate.ernest_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Evidence using a Nested Sampling Run ‚Äî calculate.ernest_run","text":"x [ernest_run] Results nested sampling run. ndraws [integer(1)] number log-volume sequences simulate. equal zero, simulations made, one draw vector log-volumes produced estimates contained x. ... dots future extensions must empty.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/calculate.ernest_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Evidence using a Nested Sampling Run ‚Äî calculate.ernest_run","text":"[tibble::tibble()] class ernest_estimate. iterative estimates nested sampling run. Contains following columns: log_lik: [rvar] log-likelihood model. log_volume: [rvar] log-volume prior space. log_weight: [rvar] log weights points live set. log_evidence: [rvar] log-evidence model. ndraws = 0, additional column included: log_evidence_err: [rvar] standard error log-evidence.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/calculate.ernest_run.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Estimate Evidence using a Nested Sampling Run ‚Äî calculate.ernest_run","text":"Higson, E., Handley, W., Hobson, M., & Lasenby, . (2019). Nestcheck: Diagnostic Tests Nested Sampling Calculations. Monthly Notices Royal Astronomical Society, 483(2), 2044‚Äì2056. doi:10.1093/mnras/sty3090","code":""},{"path":"https://kylesnap.github.io/ernest/reference/calculate.ernest_run.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Evidence using a Nested Sampling Run ‚Äî calculate.ernest_run","text":"","code":"# Load an example run data(example_run)  # View results as a tibble with `ndraws = 0`. calculate(example_run, ndraws = 0) #> Nested sampling uncertainty estimates: #> # of Simulated Draws: 0 #> Log-volume: -17 ¬± NA #> Log-evidence: -9.1 ¬± NA  # Generate 100 simulated log-volume values for each iteration. calculate(example_run, ndraws = 100) #> Nested sampling uncertainty estimates: #> # of Simulated Draws: 100 #> Log-volume: -17 ¬± 1.3 #> Log-evidence: -9.1 ¬± 0.07"},{"path":"https://kylesnap.github.io/ernest/reference/compile.ernest_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Compile the live set of points for nested sampling ‚Äî compile.ernest_sampler","title":"Compile the live set of points for nested sampling ‚Äî compile.ernest_sampler","text":"Prepares object nested sampling validating (re)generating live set. ensures sampler viable new points drawn nested sampling algorithm.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/compile.ernest_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compile the live set of points for nested sampling ‚Äî compile.ernest_sampler","text":"","code":"# S3 method for class 'ernest_sampler' compile(object, ...)  # S3 method for class 'ernest_run' compile(object, clear = FALSE, ...)"},{"path":"https://kylesnap.github.io/ernest/reference/compile.ernest_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compile the live set of points for nested sampling ‚Äî compile.ernest_sampler","text":"object [ernest_run] [ernest_sampler] Results nested sampling run. ... dots future extensions must empty. clear [logical(1)] TRUE, clears results previous runs compiling. FALSE, retains previous results validates live set.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/compile.ernest_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compile the live set of points for nested sampling ‚Äî compile.ernest_sampler","text":"copy [object]. copy guaranteed valid live set, created according class object value clear: object ernest_sampler, clear = TRUE, new live set created scratch. object ernest_run, live set regenerated previous results.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/compile.ernest_run.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compile the live set of points for nested sampling ‚Äî compile.ernest_sampler","text":"compile() validates live set bound object, ensuring : point set within unit hypercube. likelihood function returns valid values (finite double -Inf) point. live set represent perfect likelihood plateau (.e., points share likelihood). warning issued 25% points share likelihood value. validation fails, live set removed object, preventing sampling issue resolved.","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/compile.ernest_run.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compile the live set of points for nested sampling ‚Äî compile.ernest_sampler","text":"","code":"prior <- create_uniform_prior(lower = c(-1, -1), upper = 1) ll_fn <- function(x) -sum(x^2) sampler <- ernest_sampler(ll_fn, prior, nlive = 100)  # Compile the sampler to add a live set compile(sampler) #> Nested sampling run specification: #> * No. points: 100 #> * Sampling method: 25-step random walk sampling (acceptance target = 50.0%) #> * Prior: uniform prior distribution with 2 dimensions (Uniform_1 and Uniform_2) head(sampler$run_env$unit) #>            [,1]         [,2] #> [1,] 0.03694823 0.9618287729 #> [2,] 0.06791685 0.9332903884 #> [3,] 0.14663727 0.0009992414 #> [4,] 0.85656860 0.0280483754 #> [5,] 0.06376257 0.8783412096 #> [6,] 0.05198476 0.8541909819  # Continue a previous run # run <- data(example_run) # sampler_2 <- compile(example_run) # sampler_2  # Make a new sampler from a previous run sampler_3 <- compile(example_run, clear = TRUE) sampler_3 #> Nested sampling run specification: #> * No. points: 1000 #> * Sampling method: 25-step random walk sampling (acceptance target = 50.0%) #> * Prior: uniform prior distribution with 3 dimensions (x, y, and z)"},{"path":"https://kylesnap.github.io/ernest/reference/create_likelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare a likelihood function for nested sampling ‚Äî create_likelihood","title":"Prepare a likelihood function for nested sampling ‚Äî create_likelihood","text":"Creates modified version log-likelihood function always returns either finite value -Inf vector parameters provided.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/create_likelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare a likelihood function for nested sampling ‚Äî create_likelihood","text":"","code":"create_likelihood(   scalar_fn,   vectorized_fn,   on_nonfinite = c(\"warn\", \"quiet\", \"abort\") )"},{"path":"https://kylesnap.github.io/ernest/reference/create_likelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare a likelihood function for nested sampling ‚Äî create_likelihood","text":"scalar_fn, vectorized_fn [function] log-likelihood function. Provide either scalar_fn vectorized_fn: scalar_fn: accept parameter numeric vector return single numeric value representing log-likelihood, -Inf. vectorized_fn: accept matrix parameter vectors (rows samples, columns elements parameter vector) return vector log-likelihoods -Inf values row. on_nonfinite [character] sampler handle values returned fn matrix_fn finite equal -Inf. Must one : \"warn\": Issue warning return -Inf. \"quiet\": Silently return -Inf. \"abort\": Stop execution signal error.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/create_likelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare a likelihood function for nested sampling ‚Äî create_likelihood","text":"[ernest_likelihood], inherits function.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/create_likelihood.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare a likelihood function for nested sampling ‚Äî create_likelihood","text":"Provide model likelihoods log-density function, take vector free parameter values return corresponding log-likelihood value. Likelihoods typically computationally expensive function evaluate nested sampling run. ernest allows implement likelihood function single parameter vector (scalar_fn) matrix parameters (vectorized_fn). ernest expects log-likelihood function return finite double -Inf parameter vector. behaviour encountering non-finite values -Inf (NaN, Inf, NA) controlled on_nonfinite. log-likelihood depends additional data (e.g., observation matrix data frame), provide using (anonymous function)rlang::as_function() (see Examples).","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/create_likelihood.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare a likelihood function for nested sampling ‚Äî create_likelihood","text":"","code":"library(mvtnorm)  # Multivariate Normal Distribution m <- 3 mean <- rep(0, m) sigma <- diag(m) sigma[2, 1] <- sigma[1, 2] <- 3 / 5 sigma[3, 1] <- sigma[1, 3] <- 1 / 3 sigma[3, 2] <- sigma[2, 3] <- 11 / 15 prec <- solve(sigma) log_det <- -sum(log(diag(chol(sigma))))  # Provide a Scalar Log-Likelihood Function: log_lik <- function(x) {   log_det - 0.5 * m * log(2 * pi) - 0.5 * (t(x) %*% prec %*% x) } log_lik(c(0, 0, 0)) #>           [,1] #> [1,] -2.128207  # `create_likelihood` allows scalar fns. to accept matrix inputs: try(log_lik(matrix(rep(0, m * 2), nrow = 2))) #> Error in t(x) %*% prec : non-conformable arguments scalar_ll <- create_likelihood(scalar_fn = log_lik) scalar_ll(matrix(rep(0, m * 2), nrow = 2)) #> [1] -2.128207 -2.128207  # Provide a Vectorized Log-Likelihood Function: v_log_lik <- function(x) {   dmvnorm(x, mean = mean, sigma = sigma, log = TRUE) } v_log_lik(c(0, 0, 0)) #> [1] -2.128207 v_log_lik(matrix(rep(0, m * 2), nrow = 2)) #> [1] -2.128207 -2.128207  vector_ll <- create_likelihood(vectorized_fn = v_log_lik) vector_ll #> Vectorized Log-likelihood Function #> function (x)  #> { #>     dmvnorm(x, mean = mean, sigma = sigma, log = TRUE) #> }  # Control Behaviour when Nonfinite Likelihood Values are Encountered # Default: Warn and replace with `-Inf` vector_ll(c(0, 0, NA)) #> Warning: Replacing `NA` with `-Inf`. #> [1] -Inf  # Signal an error abort_ll <- create_likelihood(log_lik, on_nonfinite = \"abort\") try(abort_ll(c(0, 0, NA))) #> Error : Couldn't calculate the log-lik of 0, 0, and NA. #> Caused by error: #> ! log-lik. values must be either finite or `-Inf`. #> ‚úñ Detected non-viable value: `NA`.  # Silently replace all non-finite values quiet_ll <- create_likelihood(vectorized_fn = v_log_lik, on_nonfinite = \"quiet\") quiet_ll(c(0, 0, NA)) #> [1] -Inf"},{"path":"https://kylesnap.github.io/ernest/reference/create_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare a prior transformation for nested sampling ‚Äî create_prior","title":"Prepare a prior transformation for nested sampling ‚Äî create_prior","text":"Creates prior transformation object class ernest_prior, defines map points unit hypercube parameter space use nested sampling run.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/create_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare a prior transformation for nested sampling ‚Äî create_prior","text":"","code":"create_prior(   point_fn,   vectorized_fn,   names,   lower = -Inf,   upper = Inf,   repair = c(\"unique\", \"universal\", \"check_unique\", \"unique_quiet\", \"universal_quiet\") )  # S3 method for class 'ernest_prior' x + y"},{"path":"https://kylesnap.github.io/ernest/reference/create_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare a prior transformation for nested sampling ‚Äî create_prior","text":"point_fn, vectorized_fn [function] prior transformation function. Provide either point_fn vectorized_fn: point_fn: accept single parameter vector (numeric vector length equal number parameters) return vector original parameter space. vectorized_fn: accept matrix points unit hypercube (rows parameter vectors) return matrix shape original parameter space. names [character()] Unique names variable prior distribution. lower, upper [double()] Expected lower upper bounds parameter vectors transformation. repair [character(1)] Name repair strategy names. One \"check_unique\", \"unique\", \"universal\", \"unique_quiet\", \"universal_quiet\". See vctrs::vec_as_names() details. x, y [ernest_prior] Prior objects combine.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/create_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare a prior transformation for nested sampling ‚Äî create_prior","text":"[ernest_prior], object describing prior transformation, names, lower, upper recycled length.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/create_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare a prior transformation for nested sampling ‚Äî create_prior","text":"prior transformation encodes points parameter space independent identically distributed points within unit hypercube. Nested sampling implementations, including ernest, use transformation simplify likelihood-restricted prior sampling avoid unnecessary rejection steps. Provide prior transformation function. factorisable priors, can simply transform value (0, 1) using inverse CDF parameter. complex cases, can specify hierarchical conditionally dependent priors. create_prior performs regularity checks prior function catch basic errors may affect nested sampling. function must take vector (matrix) points (0 1) return vector matrix shape containing finite values. prior depends additional data, provide using anonymous function (see Examples).","code":""},{"path":"https://kylesnap.github.io/ernest/reference/create_prior.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Prepare a prior transformation for nested sampling ‚Äî create_prior","text":"See vctrs::vector_recycling_rules information parameters recycled common length.","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/create_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare a prior transformation for nested sampling ‚Äî create_prior","text":"","code":"# Specify a prior with independent marginals normal <- create_normal_prior(   names = c(\"beta0\", \"beta1\", \"beta2\"),   mean = 0,   sd = 5 ) uniform <- create_uniform_prior(names = \"sd\", lower = 0, upper = 5) composite <- normal + uniform composite #> composite prior distribution with 4 dimensions (beta0, beta1, beta2, and sd)  # Propose a conditional (hierarchical) prior in vectorized form fn <- function(x) {   n <- nrow(x)   out <- matrix(NA_real_, nrow = n, ncol = 3)   # x[1] follows N(5, 1)   out[, 1] <- stats::qnorm(x[, 1], mean = 5, sd = 1)   # log10(x[2]) follows Uniform(-1, 1)   out[, 2] <- 10^stats::qunif(x[, 2], min = -1, max = 1)   # x[3] follows N(x[1], x[2])   out[, 3] <- stats::qnorm(x[, 3], mean = out[, 1], sd = out[, 2])   out }  conditional_prior <- create_prior(   vectorized_fn = fn,   names = c(\"mean\", \"sd\", \"x\"),   lower = c(-Inf, 0, -Inf) )  # Plot the marginals sample <- conditional_prior$fn(matrix(runif(1000 * 3), nrow = 1000)) hist(sample[, 1], main = \"mean\")  hist(sample[, 2], main = \"sd\")  hist(sample[, 3], main = \"x\")"},{"path":"https://kylesnap.github.io/ernest/reference/ernest-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ernest: A Toolkit for Nested Sampling ‚Äî ernest-package","title":"ernest: A Toolkit for Nested Sampling ‚Äî ernest-package","text":"Bayesian evidence estimation posterior inference nested sampling algorithm, along S3 methods simulating uncertainty creating visualisations.","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/ernest-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ernest: A Toolkit for Nested Sampling ‚Äî ernest-package","text":"Maintainer: Kyle Dewsnap kyle.dewsnap@ubc.ca (ORCID)","code":""},{"path":"https://kylesnap.github.io/ernest/reference/ernest_sampler.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare a new nested sampling run ‚Äî ernest_sampler","title":"Prepare a new nested sampling run ‚Äî ernest_sampler","text":"Initializes ernest_sampler object containing components required perform nested sampling. object can used build sequences nested samples generate().","code":""},{"path":"https://kylesnap.github.io/ernest/reference/ernest_sampler.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare a new nested sampling run ‚Äî ernest_sampler","text":"","code":"ernest_sampler(   log_lik,   prior,   sampler = rwmh_cube(),   nlive = 500,   first_update = NULL,   update_interval = NULL,   seed = NA )"},{"path":"https://kylesnap.github.io/ernest/reference/ernest_sampler.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare a new nested sampling run ‚Äî ernest_sampler","text":"log_lik [function] [ernest_likelihood] function computes log-likelihood given model. function, wrapped create_likelihood(). prior [ernest_prior] Describes prior space within generate samples. sampler [ernest_lrps] Specifies likelihood-restricted prior sampling method used replace points within live set. nlive [integer(1)] number points generate within live set. Strictly positive. first_update [integer(1)] number likelihood calls make default uniform LRPS method swapping technique described sampler. Optional; left NULL set nlive * 2.5. update_interval [integer(1)] number likelihood calls updates sampler object. Optional; left NULL set nlive * 1.5. seed [integer(1)] Sets random seed controlling random number generator nested sampling runs. Optional; left NA .Random.seed set within R preserved restored run.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/ernest_sampler.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare a new nested sampling run ‚Äî ernest_sampler","text":"[ernest_sampler] named list, containing specification nested sampling run. Contains arguments passed function well environment run_env, used store live set sampling.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/ernest_sampler.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare a new nested sampling run ‚Äî ernest_sampler","text":"ernest_sampler object tested compile() returned. helps catch errors likelihood prior specifications. compilation step fails, review log_lik_fn prior objects compliance.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/ernest_sampler.html","id":"verbosity","dir":"Reference","previous_headings":"","what":"Verbosity","title":"Prepare a new nested sampling run ‚Äî ernest_sampler","text":"Messages ernest can silenced global options rlib_message_verbosity rlib_warning_verbosity. options take values: \"default\": Verbose unless .frequency argument supplied. \"verbose\": Always verbose. \"quiet\": Always quiet. set quiet, messages displayed condition signaled. See rlang::abort() information.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/ernest_sampler.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare a new nested sampling run ‚Äî ernest_sampler","text":"","code":"prior <- create_uniform_prior(lower = c(-1, -1), upper = 1) ll_fn <- function(x) -sum(x^2) sampler <- ernest_sampler(ll_fn, prior, nlive = 100) sampler #> Nested sampling run specification: #> * No. points: 100 #> * Sampling method: 25-step random walk sampling (acceptance target = 50.0%) #> * Prior: uniform prior distribution with 2 dimensions (Uniform_1 and Uniform_2)  # Use a unit-cube LRPS (not recommended in practice) unit_sampler <- ernest_sampler(   ll_fn,   prior,   nlive = 100,   sampler = unif_cube() ) unit_sampler #> Nested sampling run specification: #> * No. points: 100 #> * Sampling method: Uniform unit cube sampling #> * Prior: uniform prior distribution with 2 dimensions (Uniform_1 and Uniform_2)"},{"path":"https://kylesnap.github.io/ernest/reference/example_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Example Nested Sampling Run with Ernest ‚Äî example_run","title":"Example Nested Sampling Run with Ernest ‚Äî example_run","text":"Load precomputed example nested sampling run generated using ernest package. demonstrates typical output nested sampling run simple 3-dimensional Gaussian likelihood, uniform prior dimension. dataset intended use documentation, tutorials, gaining experience ernest_run's S3 methods.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/example_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example Nested Sampling Run with Ernest ‚Äî example_run","text":"","code":"example_run"},{"path":"https://kylesnap.github.io/ernest/reference/example_run.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example Nested Sampling Run with Ernest ‚Äî example_run","text":"object class ernest_run containing results nested sampling run.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/example_run.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example Nested Sampling Run with Ernest ‚Äî example_run","text":"example problem comes crash course dynesty Python-based nested sampling software.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/example_run.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Example Nested Sampling Run with Ernest ‚Äî example_run","text":"likelihood used generate points \\(MVN(0, \\Sigma)\\), variance \\(\\Sigma\\) set 1 covariance set 0.95. prior parameter uniform interval [-10, 10\\]. run uses following non-default settings: log_lik: 3D multivariate Gaussian mean zero covariance matrix diag(0.95, 3). prior: Uniform dimension (x, y, z) range [-10, 10]. seed: 42 View $spec element example_run see full R specification likelihood prior. [-10, 10]: R:-10,%2010%5C [-10, 10]: R:-10,%2010","code":""},{"path":"https://kylesnap.github.io/ernest/reference/generate.ernest_sampler.html","id":null,"dir":"Reference","previous_headings":"","what":"Run nested sampling to estimate Bayesian evidence ‚Äî generate.ernest_sampler","title":"Run nested sampling to estimate Bayesian evidence ‚Äî generate.ernest_sampler","text":"Executes nested sampling algorithm, iteratively replacing worst live point new sample likelihood-restricted prior stopping criterion met.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/generate.ernest_sampler.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run nested sampling to estimate Bayesian evidence ‚Äî generate.ernest_sampler","text":"","code":"# S3 method for class 'ernest_sampler' generate(   x,   max_iterations = NULL,   max_evaluations = NULL,   min_logz = 0.05,   show_progress = NULL,   ... )  # S3 method for class 'ernest_run' generate(   x,   max_iterations = NULL,   max_evaluations = NULL,   min_logz = 0.05,   show_progress = NULL,   ... )"},{"path":"https://kylesnap.github.io/ernest/reference/generate.ernest_sampler.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run nested sampling to estimate Bayesian evidence ‚Äî generate.ernest_sampler","text":"x [ernest_sampler] [ernest_run] nested sampling specification. max_iterations [integer(1)] maximum number iterations perform. Optional; NULL criterion ignored. max_evaluations [integer(1)] maximum number likelihood function evaluations perform. Optional; NULL criterion ignored. min_logz [double(1)] minimum log-ratio current estimated evidence remaining evidence. Must non-negative; set zero, criterion ignored. show_progress [logical(1)] TRUE, displays progress spinner iteration counter sampling. Optional; NULL global option rlib_message_verbosity used determine whether show progress. ... Arguments passed compile.ernest_run clear [logical(1)] TRUE, clears results previous runs compiling. FALSE, retains previous results validates live set.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/generate.ernest_sampler.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run nested sampling to estimate Bayesian evidence ‚Äî generate.ernest_sampler","text":"[ernest_run] named list containing results nested sampling run, contains nsample = nlive + niter samples prior distribution. list inherits ernest_sampler, additionally contains: niter: [integer(1)] Number iterations performed. neval: [integer(1)] Total number likelihood function evaluations. Note possible single call likelihood function evaluate likelihoods multiple parameter samples. log_evidence: [double(1)] log-evidence estimate. log_evidence_err: [double(1)] standard error log-evidence estimate, estimated information. information: [double(1)] estimated Kullback-Leibler divergence. samples: [list] posterior samples ordered log-likelihood values: original: [matrix(double(), nsample, ndim)] samples transformed parameter space. unit_cube: [matrix(double(), nsample, ndim)] samples unit hypercube. weights: [list] Additional information points generated run: id: [integer(nsample)] index point live set sample. evaluations: [integer(nsample)] number likelihood evaluations needed replace point. log_weight: [double(nsample)] log-weight sample. imp_weight: [double(nsample)] normalized importance weight sample. given normalizing log_weight log_evidence, applying exp result weights sum one. log_lik: [double(nsample)] log-likelihood sample. birth_lik: [double(nsample)] log-likelihood point used create sample.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/generate.ernest_sampler.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run nested sampling to estimate Bayesian evidence ‚Äî generate.ernest_sampler","text":"least one max_iterations, max_evaluations, min_logz must specify valid stopping criterion. Setting min_logz zero leaving max_iterations max_evaluations defaults result error. x ernest_run object, stopping criteria checked current state run. error thrown stopping criteria already satisfied x. min_logz parameter controls relative tolerance remaining evidence unexplored parameter space. Sampling stops estimated remaining evidence sufficiently small compared accumulated evidence.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/generate.ernest_sampler.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Run nested sampling to estimate Bayesian evidence ‚Äî generate.ernest_sampler","text":"Skilling, J. (2006). Nested Sampling General Bayesian Computation. Bayesian Analysis, 1(4), 833‚Äì859. doi:10.1214/06-BA127","code":""},{"path":"https://kylesnap.github.io/ernest/reference/generate.ernest_sampler.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run nested sampling to estimate Bayesian evidence ‚Äî generate.ernest_sampler","text":"","code":"prior <- create_uniform_prior(lower = c(-1, -1), upper = 1) ll_fn <- function(x) -sum(x^2) sampler <- ernest_sampler(ll_fn, prior, nlive = 100) sampler #> Nested sampling run specification: #> * No. points: 100 #> * Sampling method: 25-step random walk sampling (acceptance target = 50.0%) #> * Prior: uniform prior distribution with 2 dimensions (Uniform_1 and Uniform_2)  # Stop sampling after a set number of iterations or likelihood calls. generate(sampler, max_iterations = 100) #> Nested sampling run: #> * No. points: 100 #> * Sampling method: 25-step random walk sampling (acceptance target = 50.0%) #> * Prior: uniform prior distribution with 2 dimensions (Uniform_1 and Uniform_2) #> ‚îÄ‚îÄ Results ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * Iterations: 100 #> * Likelihood evals.: 166 #> * Log-evidence: -0.5983 (¬± 0.1235) #> * Information: 0.08405  # The final number of calls may exceed `max_evaluations`, as `generate` # only checks the number of calls when removing a live point. generate(sampler, max_evaluations = 2600) #> Nested sampling run: #> * No. points: 100 #> * Sampling method: 25-step random walk sampling (acceptance target = 50.0%) #> * Prior: uniform prior distribution with 2 dimensions (Uniform_1 and Uniform_2) #> ‚îÄ‚îÄ Results ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * Iterations: 223 #> * Likelihood evals.: 2607 #> * Log-evidence: -0.5962 (¬± 0.0745) #> * Information: 0.08494  # Use the default stopping criteria if (FALSE)  generate(sampler)  # \\dontrun{}"},{"path":"https://kylesnap.github.io/ernest/reference/multi_ellipsoid.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate new points from multiple spanning ellipsoids ‚Äî multi_ellipsoid","title":"Generate new points from multiple spanning ellipsoids ‚Äî multi_ellipsoid","text":"Partitions prior space set ellipsoids whose union bounds live set. New points created randomly selecting ellipsoid (weighted respective volumes), using generate random point unif_ellipsoid. Effective multimodal posteriors single ellipsoid inefficient.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/multi_ellipsoid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate new points from multiple spanning ellipsoids ‚Äî multi_ellipsoid","text":"","code":"multi_ellipsoid(enlarge = 1.25)"},{"path":"https://kylesnap.github.io/ernest/reference/multi_ellipsoid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate new points from multiple spanning ellipsoids ‚Äî multi_ellipsoid","text":"enlarge [double(1)] Factor inflate bounding ellipsoid's volume sampling (see Details). Must least 1.0.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/multi_ellipsoid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate new points from multiple spanning ellipsoids ‚Äî multi_ellipsoid","text":"[multi_ellipsoid], named list inherits [ernest_lrps].","code":""},{"path":"https://kylesnap.github.io/ernest/reference/multi_ellipsoid.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate new points from multiple spanning ellipsoids ‚Äî multi_ellipsoid","text":"Nested likelihood contours multimodal distributions poorly represented single ellipsoid. method fits multiple ellipsoids better capture disconnected elongated regions. Ellipsoids generated using following procedure: single ellipsoid fit live set, volume \\(V\\). live set clustered two groups using k-means clustering. Ellipsoids fit cluster. split ellipsoids accepted ellipsoids non-degenerate, combined volume split ellipsoids significantly smaller original ellipsoid (calculated using Bayes' Information Criterion). Steps 2‚Äì4 repeated recursively new ellipsoid splits accepted, updating \\(V\\) volume currently split ellipsoid.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/multi_ellipsoid.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate new points from multiple spanning ellipsoids ‚Äî multi_ellipsoid","text":"Feroz, F., Hobson, M. P., Bridges, M. (2009) MULTINEST: Efficient Robust Bayesian Inference Tool Cosmology Particle Physics. Monthly Notices Royal Astronomical Society. 398(4), 1601‚Äì1614. doi:10.1111/j.1365-2966.2009.14548.x Speagle, J. S. (2020). Dynesty: Dynamic Nested Sampling Package Estimating Bayesian Posteriors Evidences. Monthly Notices Royal Astronomical Society, 493, 3132‚Äì3158. doi:10.1093/mnras/staa278","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/multi_ellipsoid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate new points from multiple spanning ellipsoids ‚Äî multi_ellipsoid","text":"","code":"data(example_run) lrps <- multi_ellipsoid(enlarge = 1.25)  ernest_sampler(example_run$log_lik_fn, example_run$prior, sampler = lrps) #> Nested sampling run specification: #> * No. points: 500 #> * Sampling method: Uniform sampling within bounding ellipsoids (enlarged by #> 1.25) #> * Prior: uniform prior distribution with 3 dimensions (x, y, and z)"},{"path":"https://kylesnap.github.io/ernest/reference/new_ernest_lrps.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new likelihood-restricted prior sampler (LRPS) ‚Äî new_ernest_lrps","title":"Create a new likelihood-restricted prior sampler (LRPS) ‚Äî new_ernest_lrps","text":"Constructs LRPS, accepted ernest_sampler() used create new points nested sampling run.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/new_ernest_lrps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new likelihood-restricted prior sampler (LRPS) ‚Äî new_ernest_lrps","text":"","code":"new_ernest_lrps(   unit_log_fn = NULL,   n_dim = NULL,   max_loop = getOption(\"ernest.max_loop\", 1000000L),   cache = NULL,   ...,   .class = NULL,   .call = caller_env() )"},{"path":"https://kylesnap.github.io/ernest/reference/new_ernest_lrps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new likelihood-restricted prior sampler (LRPS) ‚Äî new_ernest_lrps","text":"unit_log_fn [function] Takes matrix points unit cube returns numeric vector log-likelihood values. Optional, updated called ernest_sampler(). n_dim [integer(1)] Number dimensions within prior space. Optional, updated called ernest_sampler(). max_loop [integer(1)] Maximum number attempts generate points. Inferred ernest.max_loop option. cache [environment] Environment caching information required specific LRPS method. Created left NULL. ... <dynamic-dots> Name-value pairs additional elements ernest_lrps' subclasses .class [character()] Names subclass ernest_lrps. .call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/new_ernest_lrps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new likelihood-restricted prior sampler (LRPS) ‚Äî new_ernest_lrps","text":"[ernest_lrps], named list containing arguments provided.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/new_ernest_lrps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a new likelihood-restricted prior sampler (LRPS) ‚Äî new_ernest_lrps","text":"Nested sampling relies generating series points prior space increasing log-likelihood values. accomplished using likelihood-restricted prior sampler (LRPS), generates independent identically distributed points prior, subject hard likelihood constraint. create LRPS, subclass new_ernest_lrps provide S3 methods propose() update_lrps() subclass.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/plot.ernest_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diagnostics for a nested sampling run ‚Äî plot.ernest_estimate","title":"Plot diagnostics for a nested sampling run ‚Äî plot.ernest_estimate","text":"Visualizes key diagnostics nested sampling run, including normalized likelihood, posterior weights, evidence functions log-prior volume.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/plot.ernest_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diagnostics for a nested sampling run ‚Äî plot.ernest_estimate","text":"","code":"# S3 method for class 'ernest_estimate' plot(x, which = c(\"evidence\", \"weight\", \"likelihood\"), ...)  # S3 method for class 'ernest_run' plot(x, which = c(\"evidence\", \"weight\", \"likelihood\"), ndraws = NULL, ...)"},{"path":"https://kylesnap.github.io/ernest/reference/plot.ernest_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diagnostics for a nested sampling run ‚Äî plot.ernest_estimate","text":"x [ernest_run] [ernest_estimate] object containing results nested sampling. [character()] Choose plots display. Must one \"evidence\", \"weight\", \"likelihood\". ... dots future extensions must empty. ndraws [integer(1)] number log-volume sequences simulate. equal zero, simulations made, one draw vector log-volumes produced estimates contained x.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/plot.ernest_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot diagnostics for a nested sampling run ‚Äî plot.ernest_estimate","text":"[invisible(x)]. ggplot2::ggplot() object printed side effect.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/plot.ernest_run.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot diagnostics for a nested sampling run ‚Äî plot.ernest_estimate","text":"Interpreting plots can help diagnose issues poor insufficient prior sampling model misspecification. Use select plots display: = \"evidence\": Plots estimated marginal likelihood (evidence) function log-prior volume, uncertainty intervals. Peaks plot indicate regions prior volume contribute evidence estimate. = \"weight\": Shows distribution posterior mass across log-prior volume. plot highlights regions prior volume contain posterior probability, helping identify sampler concentrated effort. = \"likelihood\": Displays normalized likelihood function log-prior volume. Smoothness plot indicates effective likelihood-restricted prior sampling, irregularities may suggest sampling difficulties , cases, misspecified likelihood functions. x ernest_run, plots based actual run data. Error ribbons drawn around evidence plot analytic estimates uncertainty (see summary.ernest_run). x ernest_estimate (ndraws specified), plots based simulated values log-volume. highest density continuous intervals (HDCIs) computed using ggdist::median_hdci() evidence weight plots.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/plot.ernest_run.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Plot diagnostics for a nested sampling run ‚Äî plot.ernest_estimate","text":"Plotting multiple diagnostics requires patchwork package. Plotting ernest_estimate objects requires ggdist package.","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/plot.ernest_run.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot diagnostics for a nested sampling run ‚Äî plot.ernest_estimate","text":"","code":"# Plot results from a run. data(example_run) plot(example_run)   # Simulate results before plotting. set.seed(42) plot(example_run, ndraws = 100)   # Equivalently, simulate results, then plot: set.seed(123) est <- calculate(example_run, ndraws = 100) plot(est)"},{"path":"https://kylesnap.github.io/ernest/reference/propose.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a new point using LRPS ‚Äî propose","title":"Generate a new point using LRPS ‚Äî propose","text":"Use LRPS method replace points within live set nested sampling run. method must implemented classes inherit ernest_lrps.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/propose.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a new point using LRPS ‚Äî propose","text":"","code":"propose(x, original = NULL, criterion = -Inf)  # S3 method for class 'multi_ellipsoid' propose(x, original = NULL, criterion = -Inf)  # S3 method for class 'rwmh_cube' propose(x, original = NULL, criterion = -Inf)  # S3 method for class 'slice_rectangle' propose(x, original = NULL, criterion = -Inf)  # S3 method for class 'unif_cube' propose(x, original = NULL, criterion = -Inf)  # S3 method for class 'unif_ellipsoid' propose(x, original = NULL, criterion = -Inf)"},{"path":"https://kylesnap.github.io/ernest/reference/propose.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a new point using LRPS ‚Äî propose","text":"x [ernest_lrps] likelihood-restricted prior sampler. original [double(x$n_dim)] parameter vector can used start proposal process. Optional; NULL proposals generated sampling unconstrained unit cube. criterion [double(1)] log-likelihood value restricts region prior space sample .","code":""},{"path":"https://kylesnap.github.io/ernest/reference/propose.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a new point using LRPS ‚Äî propose","text":"[list], containing least named elements: unit: [double(x$n_dim)] replacement point, expressed unit-cube. log_lik: [double(1)] log-likelihood value unit. neval: [integer(1)] number evaluations unit_log_fn needed generate unit. confuse number samples evaluated call propose, unit_log_fn may capable evaluating multiple parameters single call.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages ‚Äî reexports","title":"Objects exported from other packages ‚Äî reexports","text":"objects imported packages. Follow links see documentation. generics calculate, compile, generate, visualize posterior as_draws, as_draws_matrix, as_draws_rvars","code":""},{"path":"https://kylesnap.github.io/ernest/reference/rwmh_cube.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate new points with a random walk ‚Äî rwmh_cube","title":"Generate new points with a random walk ‚Äî rwmh_cube","text":"Create new samples live set evolving current point set Metropolis-Hastings random walk, rejecting steps fail meet likelihood criterion.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/rwmh_cube.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate new points with a random walk ‚Äî rwmh_cube","text":"","code":"rwmh_cube(steps = 25, target_acceptance = 0.5)"},{"path":"https://kylesnap.github.io/ernest/reference/rwmh_cube.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate new points with a random walk ‚Äî rwmh_cube","text":"steps [integer(1)] Number steps take generating proposal point. Must greater equal 2. target_acceptance [double(1)] Target acceptance rate proposed points. Must number 1 / steps 1.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/rwmh_cube.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate new points with a random walk ‚Äî rwmh_cube","text":"[rwmh_cube], named list inherits [ernest_lrps].","code":""},{"path":"https://kylesnap.github.io/ernest/reference/rwmh_cube.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate new points with a random walk ‚Äî rwmh_cube","text":"random walk LRPS generates proposals performing fixed number Metropolis-Hastings steps within unit hypercube. step proposes new location adding random perturbation current position, accepting rejecting step based whether satisfies likelihood criterion. process continues specified number steps, final accepted position returned proposal. Step-size Adaptation: step size \\(\\epsilon\\) adapted sampling rounds using update_lrps(). adaptation uses Newton-like method target desired acceptance rate \\(\\alpha_*\\). Given current acceptance rate \\(\\alpha_i\\) number dimensions \\(d\\), step size updated : $$\\epsilon_i * \\exp(\\frac{\\alpha_i - \\alpha^*}{d \\cdot \\alpha_*})$$ Given previously-accepted sample \\(X_{-1}\\) number dimensions \\(d\\), proposed points generated : $$X_{-1} + S_d(0, \\epsilon)$$ \\(S(0, \\epsilon)\\) point drawn uniformly $d$-dimensional ball centered origin radius \\(\\epsilon\\).","code":""},{"path":"https://kylesnap.github.io/ernest/reference/rwmh_cube.html","id":"control-parameters","dir":"Reference","previous_headings":"","what":"Control Parameters","title":"Generate new points with a random walk ‚Äî rwmh_cube","text":"steps: Start 25. Increase generate points closely follow posterior distribution; decrease computational efficiency. target_acceptance: Start 0.4-0.6. Lower values encourage global exploration posterior, higher values encourage explorations close starting point.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/rwmh_cube.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate new points with a random walk ‚Äî rwmh_cube","text":"Skilling, J. (2006). Nested Sampling General Bayesian Computation. Bayesian Analysis, 1(4), 833‚Äì859. doi:10.1214/06-BA127 Speagle, J. S. (2020). Dynesty: Dynamic Nested Sampling Package Estimating Bayesian Posteriors Evidences. Monthly Notices Royal Astronomical Society, 493, 3132‚Äì3158. doi:10.1093/mnras/staa278","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/rwmh_cube.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate new points with a random walk ‚Äî rwmh_cube","text":"","code":"# Basic usage with default parameters lrps <- rwmh_cube()  # A faster sampler for simple-to-traverse posterior surfaces fast_lrps <- rwmh_cube(   steps = 20,   target_acceptance = 0.7 )"},{"path":"https://kylesnap.github.io/ernest/reference/slice_rectangle.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate new points with slice sampling ‚Äî slice_rectangle","title":"Generate new points with slice sampling ‚Äî slice_rectangle","text":"Create new samples live set evolving current point set slice sampling within bounding hyperrectangle, shrinking rectangle proposals rejected.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/slice_rectangle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate new points with slice sampling ‚Äî slice_rectangle","text":"","code":"slice_rectangle(enlarge = 1)"},{"path":"https://kylesnap.github.io/ernest/reference/slice_rectangle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate new points with slice sampling ‚Äî slice_rectangle","text":"enlarge [double(1)] Factor inflate hyperrectangle's volume sampling (see Details). Optional, must greater equal 1 provided; left NA, sampling initially bounded unit hypercube iteration.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/slice_rectangle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate new points with slice sampling ‚Äî slice_rectangle","text":"[slice_rectangle], named list inherits [ernest_lrps].","code":""},{"path":"https://kylesnap.github.io/ernest/reference/slice_rectangle.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate new points with slice sampling ‚Äî slice_rectangle","text":"slice LRPS generates proposals uniformly sampling within bounding hyperrectangle contains regions parameter space satisfying likelihood criterion. Sampling begins selecting known live point \\(\\theta\\) satisfies criterion. iteration proposes new point within rectangle via uniform sampling compares criterion; rejected, new hyperrectangle drawn proposed point boundary \\(\\theta\\) interior. continues either valid proposal found rectangle shrunk point clamping operations can performed. default, hyperrectangle spans extreme values current live set dimension. may risk excluding valid regions parameter space, particularly posterior multimodal highly non-Gaussian. mitigate , set enlarge > 1, inflates hyperrectagle's volume specified factor sampling. Setting enlarge NA disables behaviour, instead slicing unit hypercube iteration.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/slice_rectangle.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate new points with slice sampling ‚Äî slice_rectangle","text":"Neal, R. M. (2000). Slice Sampling (Version 1). arXiv. doi:10.48550/ARXIV.PHYSICS/0009028","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/slice_rectangle.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate new points with slice sampling ‚Äî slice_rectangle","text":"","code":"# Basic usage with default parameters lrps <- slice_rectangle()  # More patient sampler for complex posteriors patient_lrps <- slice_rectangle(enlarge = 1.25)"},{"path":"https://kylesnap.github.io/ernest/reference/special_priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Uniform distribution ‚Äî create_normal_prior","title":"Uniform distribution ‚Äî create_normal_prior","text":"Uniform distribution","code":""},{"path":"https://kylesnap.github.io/ernest/reference/special_priors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uniform distribution ‚Äî create_normal_prior","text":"","code":"create_normal_prior(   names = NULL,   mean = 0,   sd = 1,   lower = -Inf,   upper = Inf,   repair = c(\"unique\", \"universal\", \"check_unique\", \"unique_quiet\", \"universal_quiet\") )  create_uniform_prior(   names = NULL,   lower = 0,   upper = 1,   repair = c(\"unique\", \"universal\", \"check_unique\", \"unique_quiet\", \"universal_quiet\") )"},{"path":"https://kylesnap.github.io/ernest/reference/special_priors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uniform distribution ‚Äî create_normal_prior","text":"names [character()] Optional names parameter. NULL, default names indices generated. mean, sd [double()] Mean standard deviation marginal normal distribution. sd must strictly positive. lower, upper [double()] Lower upper bounds parameter. used create_normal_prior(), define truncation limits. repair [character(1)] Name repair strategy names. One \"check_unique\", \"unique\", \"universal\", \"unique_quiet\", \"universal_quiet\". See vctrs::vec_as_names() details.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/special_priors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uniform distribution ‚Äî create_normal_prior","text":"ernest_prior, additionally inheriting specialized class uniform_prior normal_prior.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/special_priors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Uniform distribution ‚Äî create_normal_prior","text":"provided transformations vectorized: accept matrix points unit hypercube return matrix transformed values.","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/special_priors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Uniform distribution ‚Äî create_normal_prior","text":"","code":"# Specify a prior with independent marginals normal <- create_normal_prior(   names = c(\"beta0\", \"beta1\", \"beta2\"),   mean = 0,   sd = 5 ) uniform <- create_uniform_prior(names = \"sd\", lower = 0, upper = 5) composite <- normal + uniform composite #> composite prior distribution with 4 dimensions (beta0, beta1, beta2, and sd)  # Propose a conditional (hierarchical) prior in vectorized form fn <- function(x) {   n <- nrow(x)   out <- matrix(NA_real_, nrow = n, ncol = 3)   # x[1] follows N(5, 1)   out[, 1] <- stats::qnorm(x[, 1], mean = 5, sd = 1)   # log10(x[2]) follows Uniform(-1, 1)   out[, 2] <- 10^stats::qunif(x[, 2], min = -1, max = 1)   # x[3] follows N(x[1], x[2])   out[, 3] <- stats::qnorm(x[, 3], mean = out[, 1], sd = out[, 2])   out }  conditional_prior <- create_prior(   vectorized_fn = fn,   names = c(\"mean\", \"sd\", \"x\"),   lower = c(-Inf, 0, -Inf) )  # Plot the marginals sample <- conditional_prior$fn(matrix(runif(1000 * 3), nrow = 1000)) hist(sample[, 1], main = \"mean\")  hist(sample[, 2], main = \"sd\")  hist(sample[, 3], main = \"x\")"},{"path":"https://kylesnap.github.io/ernest/reference/summary.ernest_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize a nested sampling run ‚Äî summary.ernest_run","title":"Summarize a nested sampling run ‚Äî summary.ernest_run","text":"Returns concise summary ernest_run object, including key statistics description posterior distribution.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/summary.ernest_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize a nested sampling run ‚Äî summary.ernest_run","text":"","code":"# S3 method for class 'ernest_run' summary(object, ...)"},{"path":"https://kylesnap.github.io/ernest/reference/summary.ernest_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize a nested sampling run ‚Äî summary.ernest_run","text":"object [ernest_run] Results nested sampling run. ... dots future extensions must empty.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/summary.ernest_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize a nested sampling run ‚Äî summary.ernest_run","text":"[summary.ernest_run] named list, containing: nlive: [integer(1)] Number points live set. niter: [integer(1)] Number iterations. neval: [integer(1)] Number likelihood evaluations. log_evidence: [numeric(1)] Log-evidence estimate. log_evidence_err: [numeric(1)] Standard error log-evidence. information: [numeric(1)] Estimated Kullback-Leibler divergence prior posterior. reweighted_samples: [posterior::draws_matrix] Posterior samples, resampled normalized weights. mle: [list] Maximum likelihood estimate extracted run, stored list elements: log_lik: [double(1)] maximum log-likelihood value. original, unit_cube: [double(n_dim)] parameter values MLE, expressed original parameter space within unit cube. posterior: [tibble] columns posterior mean, sd, median, 15th 85th percentiles parameter. seed: RNG seed used.","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/summary.ernest_run.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize a nested sampling run ‚Äî summary.ernest_run","text":"","code":"data(example_run) run_sm <- summary(example_run) run_sm #> Summary of nested sampling run: #> ‚îÄ‚îÄ Run Information ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * No. points: 1000 #> * Iterations: 9456 #> * Likelihood evals.: 207001 #> * Log-evidence: -9.1176 (¬± 0.0833) #> * Information: 4.930 #> * RNG seed: 42 #> ‚îÄ‚îÄ Posterior Summary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> # A tibble: 3 √ó 6 #>   variable     mean    sd  median   q15   q85 #>   <chr>       <dbl> <dbl>   <dbl> <dbl> <dbl> #> 1 x        -0.00572  2.79 -0.0174 -1.94  2.00 #> 2 y         0.0302   2.80  0.0165 -1.91  2.04 #> 3 z        -0.00378  2.82  0.0192 -1.96  1.97 #> ‚îÄ‚îÄ Maximum Likelihood Estimate (MLE) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ #> * Log-likelihood: -2.6803 #> * Original parameters: 0.0097, -0.0096, and -0.0231 run_sm$posterior #> # A tibble: 3 √ó 6 #>   variable     mean    sd  median   q15   q85 #>   <chr>       <dbl> <dbl>   <dbl> <dbl> <dbl> #> 1 x        -0.00572  2.79 -0.0174 -1.94  2.00 #> 2 y         0.0302   2.80  0.0165 -1.91  2.04 #> 3 z        -0.00378  2.82  0.0192 -1.96  1.97"},{"path":"https://kylesnap.github.io/ernest/reference/unif_cube.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate new points from the unconstrained prior distribution ‚Äî unif_cube","title":"Generate new points from the unconstrained prior distribution ‚Äî unif_cube","text":"Use rejection sampling across entire prior distribution create new samples. highly inefficient LRPS, may useful testing behaviour nested sampling specification.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/unif_cube.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate new points from the unconstrained prior distribution ‚Äî unif_cube","text":"","code":"unif_cube()"},{"path":"https://kylesnap.github.io/ernest/reference/unif_cube.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate new points from the unconstrained prior distribution ‚Äî unif_cube","text":"[unif_cube], named list inherits [ernest_lrps].","code":""},{"path":"https://kylesnap.github.io/ernest/reference/unif_cube.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate new points from the unconstrained prior distribution ‚Äî unif_cube","text":"Speagle, J. S. (2020). Dynesty: Dynamic Nested Sampling Package Estimating Bayesian Posteriors Evidences. Monthly Notices Royal Astronomical Society, 493, 3132‚Äì3158. doi:10.1093/mnras/staa278","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/unif_cube.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate new points from the unconstrained prior distribution ‚Äî unif_cube","text":"","code":"data(example_run) lrps <- unif_cube()  ernest_sampler(example_run$log_lik_fn, example_run$prior, sampler = lrps) #> Nested sampling run specification: #> * No. points: 500 #> * Sampling method: Uniform unit cube sampling #> * Prior: uniform prior distribution with 3 dimensions (x, y, and z)"},{"path":"https://kylesnap.github.io/ernest/reference/unif_ellipsoid.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate new points from the spanning ellipsoid ‚Äî unif_ellipsoid","title":"Generate new points from the spanning ellipsoid ‚Äî unif_ellipsoid","text":"Uses bounding ellipsoid live set define region prior space contains new points. Effective unimodal roughly-Gaussian posteriors.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/unif_ellipsoid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate new points from the spanning ellipsoid ‚Äî unif_ellipsoid","text":"","code":"unif_ellipsoid(enlarge = 1.25)"},{"path":"https://kylesnap.github.io/ernest/reference/unif_ellipsoid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate new points from the spanning ellipsoid ‚Äî unif_ellipsoid","text":"enlarge [double(1)] Factor inflate bounding ellipsoid's volume sampling (see Details). Must least 1.0.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/unif_ellipsoid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate new points from the spanning ellipsoid ‚Äî unif_ellipsoid","text":"[unif_ellipsoid], named list inherits [ernest_lrps].","code":""},{"path":"https://kylesnap.github.io/ernest/reference/unif_ellipsoid.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate new points from the spanning ellipsoid ‚Äî unif_ellipsoid","text":"Nested likelihood contours rarely form perfect ellipses, sampling spanning ellipsoid without enlargement may exclude valid regions. can bias proposals towards ellipsoid centre overestimate evidence. Setting enlarge = 1 produce warning. covariance matrix points used estimate ellipsoid's shape. exceptional cases (e.g., perfect collinearity), matrix may singular. occur, covariance matrix reconditioned adjusting eigenvalues. also fail, algorithm falls back sampling circumscribed sphere bounding unit hypercube.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/unif_ellipsoid.html","id":"ellipsoids","dir":"Reference","previous_headings":"","what":"Ellipsoids","title":"Generate new points from the spanning ellipsoid ‚Äî unif_ellipsoid","text":"Ellipsoids stored cache environment LRPS object. Ellipsoids defined centre \\(c\\) shape matrix \\(\\). set points \\(x\\) contained within ellipsoid given $$ x \\{\\bf{R}}^n | (x-c) (x-c)' \\leq 1 $$ volume ellipsoid \\(V = \\mathrm{Vol}(S_n) \\sqrt{\\det(^{-1})}\\), \\(\\mathrm{Vol}(S_n)\\) volume unit hypersphere. sampling, store matrix \\(^{-1/2}\\), inverse positive-semidefinite square root \\(\\). ellipsoid can equivalently defined set points $$x = ^{-1/2} y + c,$$ \\(y\\) points unit hypersphere. ellipsoids operations, see Algorithms Ellipsoids S.B. Pope, Cornell University Report FDA 08-01 (2008).","code":""},{"path":"https://kylesnap.github.io/ernest/reference/unif_ellipsoid.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate new points from the spanning ellipsoid ‚Äî unif_ellipsoid","text":"Feroz, F., Hobson, M. P., Bridges, M. (2009) MULTINEST: Efficient Robust Bayesian Inference Tool Cosmology Particle Physics. Monthly Notices Royal Astronomical Society. 398(4), 1601‚Äì1614. doi:10.1111/j.1365-2966.2009.14548.x Mukherjee, P., Parkinson, D., & Liddle, . R. (2006). Nested Sampling Algorithm Cosmological Model Selection. Astrophysical Journal, 638(2), L51. doi:10.1086/501068","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/unif_ellipsoid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate new points from the spanning ellipsoid ‚Äî unif_ellipsoid","text":"","code":"data(example_run) lrps <- unif_ellipsoid(enlarge = 1.25)  ernest_sampler(example_run$log_lik_fn, example_run$prior, sampler = lrps) #> Nested sampling run specification: #> * No. points: 500 #> * Sampling method: Uniform sampling within a bounding ellipsoid (enlarged by #> 1.25) #> * Prior: uniform prior distribution with 3 dimensions (x, y, and z)"},{"path":"https://kylesnap.github.io/ernest/reference/update_lrps.html","id":null,"dir":"Reference","previous_headings":"","what":"Update an LRPS ‚Äî update_lrps","title":"Update an LRPS ‚Äî update_lrps","text":"Update behaviour likelihood-restricted prior sampler interim information nested sampling run.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/update_lrps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update an LRPS ‚Äî update_lrps","text":"","code":"update_lrps(x, ...)  # S3 method for class 'multi_ellipsoid' update_lrps(x, unit = NULL, log_volume = NA, ...)  # S3 method for class 'rwmh_cube' update_lrps(x, unit = NULL, ...)  # S3 method for class 'slice_rectangle' update_lrps(x, unit = NULL, ...)  # S3 method for class 'unif_ellipsoid' update_lrps(x, unit = NULL, log_volume = NA, ...)"},{"path":"https://kylesnap.github.io/ernest/reference/update_lrps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update an LRPS ‚Äî update_lrps","text":"x [ernest_lrps] likelihood-restricted prior sampler. ... Presently ignored. unit [matrix(double(), integer(), x$n_dim)] current live set stored within run. Optional; NULL LRPS updates based state live set made. log_volume [double(1)] current log-volume nested sampling run.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/update_lrps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update an LRPS ‚Äî update_lrps","text":"[ernest_lrps], created reconstructing x updated parameters.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/update_lrps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Update an LRPS ‚Äî update_lrps","text":"nested sampling run, may wish update internal parameters LRPS based sampler performance criterion. frequency updates set first_update update_interval arguments ernest_sampler(). creating ernest_lrps subclass, implement method specify special update behaviour. default method reconstructs LRPS current parameters resets likelihood call counter cache.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/visualize.ernest_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize posterior distributions or traces from a nested sampling run ‚Äî visualize.ernest_run","title":"Visualize posterior distributions or traces from a nested sampling run ‚Äî visualize.ernest_run","text":"Produces visualizations posterior distributions evolution variables along log-prior volume nested sampling run.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/visualize.ernest_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize posterior distributions or traces from a nested sampling run ‚Äî visualize.ernest_run","text":"","code":"# S3 method for class 'ernest_run' visualize(   x,   ...,   .which = c(\"density\", \"trace\"),   .units = c(\"original\", \"unit_cube\"),   .radial = FALSE )"},{"path":"https://kylesnap.github.io/ernest/reference/visualize.ernest_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize posterior distributions or traces from a nested sampling run ‚Äî visualize.ernest_run","text":"x [ernest_run] results nested sampling run. ... <tidy-select> One variables plot run. omitted, variables plotted. .[charcacter(1)] Character string specifying type plot produce. Options \"density\" posterior density parameter \"trace\" trace variables along log-volume. .units [character(1)] scale sampled points: \"original\": Points scale prior space. \"unit_cube\": Points (0, 1) unit hypercube scale. .radial [logical(1)] TRUE, returns additional column .radial containing radial coordinate (.e., Euclidean norm) sampled point.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/visualize.ernest_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize posterior distributions or traces from a nested sampling run ‚Äî visualize.ernest_run","text":"ggplot2::ggplot() object.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/visualize.ernest_run.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualize posterior distributions or traces from a nested sampling run ‚Äî visualize.ernest_run","text":"visualize() function designed quickly explore results nested sampling run two types plots: Density plots show marginal posterior selected variable, using ggdist::stat_halfeye() visualize uncertainty distribution shape. Trace plots display evolution variables function log-volume, points coloured posterior weight. can help diagnose sampling behavior identify regions interest prior volume. Posterior weights derived individual contributions sampled point prior space run's log-evidence estimate. point's weight function () point's likelihood (b) estimated amount volume within point's likelihood contour. See ernest's vignettes information.","code":""},{"path":"https://kylesnap.github.io/ernest/reference/visualize.ernest_run.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Visualize posterior distributions or traces from a nested sampling run ‚Äî visualize.ernest_run","text":"package requires tidyselect package installed. = \"trace\" selected, ggdist package also required.","code":""},{"path":[]},{"path":"https://kylesnap.github.io/ernest/reference/visualize.ernest_run.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize posterior distributions or traces from a nested sampling run ‚Äî visualize.ernest_run","text":"","code":"# Load example run library(ggdist) data(example_run)  # Plot posterior densities for all parameters visualize(example_run, .which = \"density\")   # Plot trace of the radial coordinate in unit-cube scale visualize(   example_run,   .which = \"trace\",   .units = \"unit_cube\",   .radial = TRUE )"}]
